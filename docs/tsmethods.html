<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 tsmethods package | A Time Series Framework</title>
  <meta name="description" content="Documentation for the tsmodels framework" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 tsmethods package | A Time Series Framework" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Documentation for the tsmodels framework" />
  <meta name="github-repo" content="tsmodels/tsmodels.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 tsmethods package | A Time Series Framework" />
  
  <meta name="twitter:description" content="Documentation for the tsmodels framework" />
  

<meta name="author" content="The tsmodels team" />


<meta name="date" content="2020-09-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="tsets.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series Forecasting Framework</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> The tsmodels team</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="tsmethods.html"><a href="tsmethods.html"><i class="fa fa-check"></i><b>3</b> tsmethods package</a><ul>
<li class="chapter" data-level="3.1" data-path="tsmethods.html"><a href="tsmethods.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="tsmethods.html"><a href="tsmethods.html#tsmethods-simulation"><i class="fa fa-check"></i><b>3.2</b> Ensembling Forecast Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="tsmethods.html"><a href="tsmethods.html#demonstration"><i class="fa fa-check"></i><b>3.3</b> Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tsets.html"><a href="tsets.html"><i class="fa fa-check"></i><b>4</b> tsets package</a><ul>
<li class="chapter" data-level="4.1" data-path="tsets.html"><a href="tsets.html#tsets:intro"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="tsets.html"><a href="tsets.html#tsets:taxonomy"><i class="fa fa-check"></i><b>4.2</b> Taxonomy of Models</a></li>
<li class="chapter" data-level="4.3" data-path="tsets.html"><a href="tsets.html#tsets:extensions"><i class="fa fa-check"></i><b>4.3</b> Extensions</a></li>
<li class="chapter" data-level="4.4" data-path="tsets.html"><a href="tsets.html#some-encompasing-alternatives"><i class="fa fa-check"></i><b>4.4</b> Some Encompasing Alternatives</a></li>
<li class="chapter" data-level="4.5" data-path="tsets.html"><a href="tsets.html#tsets:implementation"><i class="fa fa-check"></i><b>4.5</b> Package Implementation</a><ul>
<li class="chapter" data-level="4.5.1" data-path="tsets.html"><a href="tsets.html#tsets:implementation:constraints"><i class="fa fa-check"></i><b>4.5.1</b> Constraints</a></li>
<li class="chapter" data-level="4.5.2" data-path="tsets.html"><a href="tsets.html#tsets:implementation:initialization"><i class="fa fa-check"></i><b>4.5.2</b> Initialization</a></li>
<li class="chapter" data-level="4.5.3" data-path="tsets.html"><a href="tsets.html#tsets:implementation:transformations"><i class="fa fa-check"></i><b>4.5.3</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tsets.html"><a href="tsets.html#tsets:demonstration"><i class="fa fa-check"></i><b>4.6</b> Demonstration</a><ul>
<li class="chapter" data-level="4.6.1" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:specification"><i class="fa fa-check"></i><b>4.6.1</b> The Specification Object</a></li>
<li class="chapter" data-level="4.6.2" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:estimation"><i class="fa fa-check"></i><b>4.6.2</b> Estimation</a></li>
<li class="chapter" data-level="4.6.3" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:prediction"><i class="fa fa-check"></i><b>4.6.3</b> Prediction</a></li>
<li class="chapter" data-level="4.6.4" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:filtering"><i class="fa fa-check"></i><b>4.6.4</b> Filtering</a></li>
<li class="chapter" data-level="4.6.5" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:simulation"><i class="fa fa-check"></i><b>4.6.5</b> Simulation</a></li>
<li class="chapter" data-level="4.6.6" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:profiling"><i class="fa fa-check"></i><b>4.6.6</b> Profiling</a></li>
<li class="chapter" data-level="4.6.7" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:backtesting"><i class="fa fa-check"></i><b>4.6.7</b> Backtesting</a></li>
<li class="chapter" data-level="4.6.8" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:benchmarking"><i class="fa fa-check"></i><b>4.6.8</b> Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tsissm.html"><a href="tsissm.html"><i class="fa fa-check"></i><b>5</b> tsissm package</a><ul>
<li class="chapter" data-level="5.1" data-path="tsissm.html"><a href="tsissm.html#tsissm:introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="tsissm.html"><a href="tsissm.html#tsissm:initialization"><i class="fa fa-check"></i><b>5.2</b> State Initialization</a></li>
<li class="chapter" data-level="5.3" data-path="tsissm.html"><a href="tsissm.html#tsissm:likelihood"><i class="fa fa-check"></i><b>5.3</b> Log-Likelihood</a></li>
<li class="chapter" data-level="5.4" data-path="tsissm.html"><a href="tsissm.html#tsissm:implementation"><i class="fa fa-check"></i><b>5.4</b> Package Implementation</a></li>
<li class="chapter" data-level="5.5" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration"><i class="fa fa-check"></i><b>5.5</b> Demonstration</a><ul>
<li class="chapter" data-level="5.5.1" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:specification"><i class="fa fa-check"></i><b>5.5.1</b> Specification</a></li>
<li class="chapter" data-level="5.5.2" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:estimation"><i class="fa fa-check"></i><b>5.5.2</b> Estimation</a></li>
<li class="chapter" data-level="5.5.3" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:prediction"><i class="fa fa-check"></i><b>5.5.3</b> Prediction</a></li>
<li class="chapter" data-level="5.5.4" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:simulation"><i class="fa fa-check"></i><b>5.5.4</b> Simulation</a></li>
<li class="chapter" data-level="5.5.5" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:filtering"><i class="fa fa-check"></i><b>5.5.5</b> Filtering</a></li>
<li class="chapter" data-level="5.5.6" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:profiling"><i class="fa fa-check"></i><b>5.5.6</b> Profiling</a></li>
<li class="chapter" data-level="5.5.7" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:backtesting"><i class="fa fa-check"></i><b>5.5.7</b> Backtesting</a></li>
<li class="chapter" data-level="5.5.8" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:benchmarking"><i class="fa fa-check"></i><b>5.5.8</b> Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tsvets.html"><a href="tsvets.html"><i class="fa fa-check"></i><b>6</b> tsvets package</a><ul>
<li class="chapter" data-level="6.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:regressors"><i class="fa fa-check"></i><b>6.2</b> Inclusion of External Regressors</a></li>
<li class="chapter" data-level="6.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:likelihood"><i class="fa fa-check"></i><b>6.3</b> Log-Likelihood</a></li>
<li class="chapter" data-level="6.4" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence"><i class="fa fa-check"></i><b>6.4</b> Dependence Structure</a><ul>
<li class="chapter" data-level="6.4.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:diagonal"><i class="fa fa-check"></i><b>6.4.1</b> Diagonal Covariance</a></li>
<li class="chapter" data-level="6.4.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:equicorrelation"><i class="fa fa-check"></i><b>6.4.2</b> Equicorrelation</a></li>
<li class="chapter" data-level="6.4.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:shrinkage"><i class="fa fa-check"></i><b>6.4.3</b> Shrinkage Covariance</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="tsvets.html"><a href="tsvets.html#tsvets:grouping"><i class="fa fa-check"></i><b>6.5</b> Grouping and Pooling</a></li>
<li class="chapter" data-level="6.6" data-path="tsvets.html"><a href="tsvets.html#tsvets:homogeneous"><i class="fa fa-check"></i><b>6.6</b> Homogeneous Coefficients and Aggregation</a></li>
<li class="chapter" data-level="6.7" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration"><i class="fa fa-check"></i><b>6.7</b> Demonstration</a><ul>
<li class="chapter" data-level="6.7.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:specification"><i class="fa fa-check"></i><b>6.7.1</b> Specification</a></li>
<li class="chapter" data-level="6.7.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example1"><i class="fa fa-check"></i><b>6.7.2</b> Example: Australian Retail Sales</a></li>
<li class="chapter" data-level="6.7.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example2"><i class="fa fa-check"></i><b>6.7.3</b> Example: Australian Retail Sales Grouped Dynamics</a></li>
<li class="chapter" data-level="6.7.4" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example3"><i class="fa fa-check"></i><b>6.7.4</b> Example: Australian Retail Sales Filtering</a></li>
<li class="chapter" data-level="6.7.5" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example4"><i class="fa fa-check"></i><b>6.7.5</b> Example: Australian Retail Sales Aggregation</a></li>
<li class="chapter" data-level="6.7.6" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example5"><i class="fa fa-check"></i><b>6.7.6</b> Example: Price Volume Aggregation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tsforeign.html"><a href="tsforeign.html"><i class="fa fa-check"></i><b>7</b> tsforeign package</a><ul>
<li class="chapter" data-level="7.1" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:arima"><i class="fa fa-check"></i><b>7.2</b> ARIMA model</a></li>
<li class="chapter" data-level="7.3" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:bsts"><i class="fa fa-check"></i><b>7.3</b> bsts model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="other.html"><a href="other.html"><i class="fa fa-check"></i><b>8</b> Other packages</a></li>
<li class="chapter" data-level="9" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>9</b> Installation</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Time Series Framework</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tsmethods" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> tsmethods package</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<p>The <strong>tsmethods</strong> package provides a set of common methods for use in other packages in our framework. Additionally, it also exports <code>plot</code> methods for objects of class <code>tsmodel.predict</code>, which is the output class from all calls to the <code>predict</code> method, as well as for objects of class <code>tsmodel.distribution</code>, which is a subclass within <code>tsmodel.predict</code> providing the simulated or MCMC based forecast distribution.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Finally, the package also includes the methods for ensembling distributions. Table <a href="tsmethods.html#tab:methods">3.1</a> below provides the currently exported methods for each of the packages which have been released. We have tried to work with existing S3 methods in the <strong>stats</strong> package where possible including: <code>summary</code>, <code>coef</code>, <code>logLik</code>, <code>AIC</code>, <code>fitted</code>, <code>residuals</code>, <code>predict</code> and <code>simulate</code>. However, we have also created custom methods such as <code>estimate</code> (for model estimation from a specification object), <code>tsdecompose</code> (for time series decomposition of structural time series type models), <code>tsfilter</code> for online filtering<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, <code>tsbacktest</code> (for automated backtesting) as well as a number of other methods documented in their individual packages.</p>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:methods">TABLE 3.1: </span>Implemented Methods
</caption>
<thead>
<tr>
<th style="text-align:left;">
methods
</th>
<th style="text-align:center;">
tsets
</th>
<th style="text-align:center;">
tsissm
</th>
<th style="text-align:left;">
tsvets
</th>
<th style="text-align:center;">
tsforeign
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
estimate
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
✓
</td>
</tr>
<tr>
<td style="text-align:left;">
summary
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
✓
</td>
</tr>
<tr>
<td style="text-align:left;">
coef
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
logLik
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
fitted
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
✓
</td>
</tr>
<tr>
<td style="text-align:left;">
residuals
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
✓
</td>
</tr>
<tr>
<td style="text-align:left;">
plot
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
✓
</td>
</tr>
<tr>
<td style="text-align:left;">
tsmetrics
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
✓
</td>
</tr>
<tr>
<td style="text-align:left;">
tsspec
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
tsdiagnose
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
tsdecompose
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
✓
</td>
</tr>
<tr>
<td style="text-align:left;">
tsfilter
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
tsprofile
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
predict
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
✓
</td>
</tr>
<tr>
<td style="text-align:left;">
tsbacktest
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
✓
</td>
</tr>
<tr>
<td style="text-align:left;">
simulate
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
tsbenchmark
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
tsreport
</td>
<td style="text-align:center;">
✓
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
tscor
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
tscov
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
tsaggregate
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
✓
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
tsconvert
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
✓
</td>
</tr>
<tr>
<td style="text-align:left;">
tsequation
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
</div>
<div id="tsmethods-simulation" class="section level2">
<h2><span class="header-section-number">3.2</span> Ensembling Forecast Distributions</h2>
<p>Ensembling in the tsmodels framework proceeds as follows:</p>
<ul>
<li>(Separate) models are estimated for either the same series or a set of different series.</li>
<li>The residuals of the estimated series are collected and the residual correlation is calculated. For very large-dimensional systems (where <span class="math inline">\(N\)</span> &gt; <span class="math inline">\(T\)</span>) it is possible instead to use a factor model to extract the correlations, but we leave this for a separate discussion.</li>
<li>The estimated correlations are then used to generate correlated samples on the unit hypercube (using for instance a copula).</li>
<li>These samples are then passed to the <code>innov</code> argument in the <code>predict</code> method of each model, at which time they are transformed to normal random variables with variance equal to the estimated model variance.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> A key reason for using uniform variates and transforming them back into normal variates within the predict method is the possible presence of the Box Cox transformation, which requires that the variance be on the transformed scale rather than the final series scale. It was therefore decided that this approach was more general and less prone to user error.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></li>
<li>The predictive distribution, which is generated by simulation, will then be infused with the cross-sectional correlation of the residuals passed to the predict method.
<strong>Note: This approach works well for models with a single source of error such as ARIMA and ETS, but NOT for multiple source of error models such as BSTS.</strong></li>
<li>The predictive distributions are then passed to the <code>ensemble_modelspec</code> function for validation, followed by calling the <code>tsensemble</code> method on the resulting object with a vector of user specified weights.</li>
</ul>
<p>The next section provides a demonstration of this approach.</p>
</div>
<div id="demonstration" class="section level2">
<h2><span class="header-section-number">3.3</span> Demonstration</h2>
<p>Step 1: Estimation</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="tsmethods.html#cb1-1"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(tsmethods))</span>
<span id="cb1-2"><a href="tsmethods.html#cb1-2"></a><span class="kw">suppressWarnings</span>(<span class="kw">suppressMessages</span>(<span class="kw">library</span>(tsets)))</span>
<span id="cb1-3"><a href="tsmethods.html#cb1-3"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(xts))</span>
<span id="cb1-4"><a href="tsmethods.html#cb1-4"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(copula))</span>
<span id="cb1-5"><a href="tsmethods.html#cb1-5"></a><span class="kw">suppressWarnings</span>(<span class="kw">suppressMessages</span>(<span class="kw">library</span>(viridis)))</span>
<span id="cb1-6"><a href="tsmethods.html#cb1-6"></a><span class="kw">data</span>(austretail, <span class="dt">package =</span> <span class="st">&quot;tsdatasets&quot;</span>)</span>
<span id="cb1-7"><a href="tsmethods.html#cb1-7"></a>y1 &lt;-<span class="st"> </span>austretail[,<span class="st">&quot;SA.DS&quot;</span>]</span>
<span id="cb1-8"><a href="tsmethods.html#cb1-8"></a>y2 &lt;-<span class="st"> </span>austretail[,<span class="st">&quot;ACF.DS&quot;</span>]</span>
<span id="cb1-9"><a href="tsmethods.html#cb1-9"></a>spec1 &lt;-<span class="st"> </span><span class="kw">ets_modelspec</span>(y1, <span class="dt">model =</span> <span class="st">&quot;MMM&quot;</span>, <span class="dt">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb1-10"><a href="tsmethods.html#cb1-10"></a>spec2 &lt;-<span class="st"> </span><span class="kw">ets_modelspec</span>(y2, <span class="dt">model =</span> <span class="st">&quot;MMM&quot;</span>, <span class="dt">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb1-11"><a href="tsmethods.html#cb1-11"></a>mod1 &lt;-<span class="st"> </span><span class="kw">estimate</span>(spec1)</span>
<span id="cb1-12"><a href="tsmethods.html#cb1-12"></a>mod2 &lt;-<span class="st"> </span><span class="kw">estimate</span>(spec2)</span></code></pre></div>
<p>Step 2: Residual Correlation and Copula Construction/Sampling</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="tsmethods.html#cb2-1"></a>C &lt;-<span class="st"> </span><span class="kw">cor</span>(<span class="kw">residuals</span>(mod1), <span class="kw">residuals</span>(mod2))</span>
<span id="cb2-2"><a href="tsmethods.html#cb2-2"></a>cop &lt;-<span class="st"> </span><span class="kw">normalCopula</span>(<span class="kw">as.numeric</span>(C), <span class="dt">dim =</span> <span class="dv">2</span>, <span class="dt">dispstr =</span> <span class="st">&quot;un&quot;</span>)</span>
<span id="cb2-3"><a href="tsmethods.html#cb2-3"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb2-4"><a href="tsmethods.html#cb2-4"></a>U &lt;-<span class="st"> </span><span class="kw">rCopula</span>(<span class="dv">5000</span> <span class="op">*</span><span class="st"> </span><span class="dv">12</span>, cop)</span>
<span id="cb2-5"><a href="tsmethods.html#cb2-5"></a><span class="kw">cor</span>(U)</span></code></pre></div>
<pre><code>##         [,1]    [,2]
## [1,] 1.00000 0.58779
## [2,] 0.58779 1.00000</code></pre>
<p>Step 3: Prediction</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="tsmethods.html#cb4-1"></a>p1.joint &lt;-<span class="st"> </span><span class="kw">predict</span>(mod1, <span class="dt">h =</span> <span class="dv">12</span>, <span class="dt">nsim =</span> <span class="dv">5000</span>, <span class="dt">innov =</span> U[,<span class="dv">1</span>])</span>
<span id="cb4-2"><a href="tsmethods.html#cb4-2"></a>p2.joint &lt;-<span class="st"> </span><span class="kw">predict</span>(mod2, <span class="dt">h =</span> <span class="dv">12</span>, <span class="dt">nsim =</span> <span class="dv">5000</span>, <span class="dt">innov =</span> U[,<span class="dv">2</span>])</span>
<span id="cb4-3"><a href="tsmethods.html#cb4-3"></a>p1.indep &lt;-<span class="st"> </span><span class="kw">predict</span>(mod1, <span class="dt">h =</span> <span class="dv">12</span>, <span class="dt">nsim =</span> <span class="dv">5000</span>)</span>
<span id="cb4-4"><a href="tsmethods.html#cb4-4"></a>p2.indep &lt;-<span class="st"> </span><span class="kw">predict</span>(mod2, <span class="dt">h =</span> <span class="dv">12</span>, <span class="dt">nsim =</span> <span class="dv">5000</span>)</span>
<span id="cb4-5"><a href="tsmethods.html#cb4-5"></a></span>
<span id="cb4-6"><a href="tsmethods.html#cb4-6"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb4-7"><a href="tsmethods.html#cb4-7"></a><span class="kw">plot</span>(p1.joint, <span class="dt">main =</span> <span class="st">&quot;Correlated Predictions[y1]&quot;</span>, <span class="dt">n_original =</span> <span class="dv">52</span>)</span>
<span id="cb4-8"><a href="tsmethods.html#cb4-8"></a><span class="kw">plot</span>(p2.joint, <span class="dt">main =</span> <span class="st">&quot;Correlated Predictions[y2]&quot;</span>, <span class="dt">n_original =</span> <span class="dv">52</span>)</span>
<span id="cb4-9"><a href="tsmethods.html#cb4-9"></a><span class="kw">plot</span>(p1.indep, <span class="dt">main =</span> <span class="st">&quot;Independent Predictions[y1]&quot;</span>, <span class="dt">n_original =</span> <span class="dv">52</span>)</span>
<span id="cb4-10"><a href="tsmethods.html#cb4-10"></a><span class="kw">plot</span>(p2.indep, <span class="dt">main =</span> <span class="st">&quot;Independent Predictions[y2]&quot;</span>, <span class="dt">n_original =</span> <span class="dv">52</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/ensemble3-1.png" width="672" /></p>
<p>We can also plot the distributions directly, since there is a plot method for both <code>tsmodel.predict</code> and <code>tsmodel.distribution</code>, and we can also overlay one on top of another by using the <code>add = TRUE</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="tsmethods.html#cb5-1"></a><span class="kw">plot</span>(p1.joint<span class="op">$</span>distribution, <span class="dt">gradient_color =</span> <span class="st">&quot;whitesmoke&quot;</span>, <span class="dt">median_col =</span> <span class="st">&quot;grey&quot;</span>, </span>
<span id="cb5-2"><a href="tsmethods.html#cb5-2"></a>     <span class="dt">median_width =</span> <span class="dv">4</span>, <span class="dt">interval_color =</span> <span class="dv">3</span>, <span class="dt">interval_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>), </span>
<span id="cb5-3"><a href="tsmethods.html#cb5-3"></a>     <span class="dt">main =</span> <span class="st">&quot;SA.DS 12 Month Prediction&quot;</span>)</span>
<span id="cb5-4"><a href="tsmethods.html#cb5-4"></a><span class="kw">plot</span>(p1.indep<span class="op">$</span>distribution, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">median_col =</span> <span class="dv">2</span>, <span class="dt">median_width =</span> <span class="dv">1</span>, </span>
<span id="cb5-5"><a href="tsmethods.html#cb5-5"></a>     <span class="dt">gradient_color =</span> <span class="st">&quot;whitesmoke&quot;</span>, <span class="dt">interval_color =</span> <span class="dv">2</span>, </span>
<span id="cb5-6"><a href="tsmethods.html#cb5-6"></a>     <span class="dt">interval_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>), <span class="dt">interval_width =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Evaluation of Predictive Distributions on Forecast Growth Rates</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="tsmethods.html#cb6-1"></a>p1.growth.joint &lt;-<span class="st"> </span><span class="kw">tsgrowth</span>(p1.joint, <span class="dt">d =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&#39;diff&#39;</span>)</span>
<span id="cb6-2"><a href="tsmethods.html#cb6-2"></a>p2.growth.joint &lt;-<span class="st"> </span><span class="kw">tsgrowth</span>(p2.joint, <span class="dt">d =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&#39;diff&#39;</span>)</span>
<span id="cb6-3"><a href="tsmethods.html#cb6-3"></a>p1.growth.indep &lt;-<span class="st"> </span><span class="kw">tsgrowth</span>(p1.indep, <span class="dt">d =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&#39;diff&#39;</span>)</span>
<span id="cb6-4"><a href="tsmethods.html#cb6-4"></a>p2.growth.indep &lt;-<span class="st"> </span><span class="kw">tsgrowth</span>(p2.indep, <span class="dt">d =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&#39;diff&#39;</span>)</span>
<span id="cb6-5"><a href="tsmethods.html#cb6-5"></a></span>
<span id="cb6-6"><a href="tsmethods.html#cb6-6"></a>D.joint &lt;-<span class="st"> </span><span class="kw">cor</span>(p1.growth.joint<span class="op">$</span>distribution, p2.growth.joint<span class="op">$</span>distribution)</span>
<span id="cb6-7"><a href="tsmethods.html#cb6-7"></a>D.indep &lt;-<span class="st"> </span><span class="kw">cor</span>(p1.growth.indep<span class="op">$</span>distribution, p2.growth.indep<span class="op">$</span>distribution)</span>
<span id="cb6-8"><a href="tsmethods.html#cb6-8"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">data.frame</span>(<span class="dt">Correlated =</span> <span class="kw">diag</span>(D.joint), </span>
<span id="cb6-9"><a href="tsmethods.html#cb6-9"></a>                       <span class="dt">Independent =</span> <span class="kw">diag</span>(D.indep)), <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##            Correlated Independent
## 2019-01-31      0.600      -0.021
## 2019-02-28      0.600      -0.004
## 2019-03-31      0.597       0.018
## 2019-04-30      0.606       0.012
## 2019-05-31      0.598       0.004
## 2019-06-30      0.602       0.002
## 2019-07-31      0.604       0.004
## 2019-08-31      0.609       0.002
## 2019-09-30      0.624       0.000
## 2019-10-31      0.608      -0.003
## 2019-11-30      0.612      -0.009
## 2019-12-31      0.601      -0.017</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="tsmethods.html#cb8-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb8-2"><a href="tsmethods.html#cb8-2"></a><span class="kw">image</span>(<span class="kw">as.matrix</span>(D.joint), <span class="dt">col =</span> <span class="kw">rev</span>(<span class="kw">grey</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">25</span>))), </span>
<span id="cb8-3"><a href="tsmethods.html#cb8-3"></a>      <span class="dt">zlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">main =</span> <span class="st">&quot;Correlated&quot;</span>)</span>
<span id="cb8-4"><a href="tsmethods.html#cb8-4"></a><span class="kw">contour</span>(<span class="kw">cor</span>(p1.joint<span class="op">$</span>distribution, p2.joint<span class="op">$</span>distribution), <span class="dt">add =</span> <span class="ot">TRUE</span>, </span>
<span id="cb8-5"><a href="tsmethods.html#cb8-5"></a>        <span class="dt">drawlabels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb8-6"><a href="tsmethods.html#cb8-6"></a><span class="kw">image</span>(D.indep, <span class="dt">col =</span> <span class="kw">rev</span>(<span class="kw">grey</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">25</span>))), <span class="dt">zlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb8-7"><a href="tsmethods.html#cb8-7"></a>      <span class="dt">main =</span> <span class="st">&quot;Independent&quot;</span>)</span>
<span id="cb8-8"><a href="tsmethods.html#cb8-8"></a><span class="kw">contour</span>(D.indep, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">drawlabels =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/ensemble3.1-1.png" width="672" /></p>
<p>Step 4: Forecast Ensembling</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="tsmethods.html#cb9-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb9-2"><a href="tsmethods.html#cb9-2"></a>spec.joint &lt;-<span class="st"> </span><span class="kw">ensemble_modelspec</span>(p1.joint, p2.joint)</span>
<span id="cb9-3"><a href="tsmethods.html#cb9-3"></a>ensemble.joint &lt;-<span class="st"> </span><span class="kw">tsensemble</span>(spec.joint, <span class="dt">weights =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb9-4"><a href="tsmethods.html#cb9-4"></a><span class="kw">plot</span>(ensemble.joint, <span class="dt">main =</span> <span class="st">&quot;Ensemble Weighted Forecast&quot;</span>, <span class="dt">n_original =</span> <span class="dv">52</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/ensemble4-1.png" width="672" /></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>The current choice of using base R plotting may change in the future to use either ggplot2 or plotly.<a href="tsmethods.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Unlike some, we have avoided using <code>stats::filter</code> as this is a function rather than a method.<a href="tsmethods.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>The samples can be transformed to any other distribution using the quantile method of the distribution.<a href="tsmethods.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Additionally the marginal distributions of the individual series may not all be the same, so this approach provides some greater degree of flexibility.<a href="tsmethods.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tsets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
