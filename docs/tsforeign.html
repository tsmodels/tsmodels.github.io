<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 tsforeign package | A Time Series Framework</title>
  <meta name="description" content="Documentation for the tsmodels framework" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 tsforeign package | A Time Series Framework" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Documentation for the tsmodels framework" />
  <meta name="github-repo" content="tsmodels/tsmodels.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 tsforeign package | A Time Series Framework" />
  
  <meta name="twitter:description" content="Documentation for the tsmodels framework" />
  

<meta name="author" content="The tsmodels team" />


<meta name="date" content="2022-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tsvets.html"/>
<link rel="next" href="tscausal.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-177357579-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  
  function gtag(){dataLayer.push(arguments);}
  
  gtag('js', new Date());
  
  gtag('config', 'UA-177357579-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series Forecasting Framework</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Installation</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="tsmethods.html"><a href="tsmethods.html"><i class="fa fa-check"></i><b>3</b> tsmethods package</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tsmethods.html"><a href="tsmethods.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="tsmethods.html"><a href="tsmethods.html#tsmethods:simulation"><i class="fa fa-check"></i><b>3.2</b> Ensembling Forecast Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="tsmethods.html"><a href="tsmethods.html#demonstration"><i class="fa fa-check"></i><b>3.3</b> Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tsets.html"><a href="tsets.html"><i class="fa fa-check"></i><b>4</b> tsets package</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tsets.html"><a href="tsets.html#tsets:intro"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="tsets.html"><a href="tsets.html#tsets:taxonomy"><i class="fa fa-check"></i><b>4.2</b> Taxonomy of Models</a></li>
<li class="chapter" data-level="4.3" data-path="tsets.html"><a href="tsets.html#tsets:extensions"><i class="fa fa-check"></i><b>4.3</b> Extensions</a></li>
<li class="chapter" data-level="4.4" data-path="tsets.html"><a href="tsets.html#some-encompasing-alternatives"><i class="fa fa-check"></i><b>4.4</b> Some Encompasing Alternatives</a></li>
<li class="chapter" data-level="4.5" data-path="tsets.html"><a href="tsets.html#tsets:implementation"><i class="fa fa-check"></i><b>4.5</b> Package Implementation</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="tsets.html"><a href="tsets.html#tsets:implementation:constraints"><i class="fa fa-check"></i><b>4.5.1</b> Constraints</a></li>
<li class="chapter" data-level="4.5.2" data-path="tsets.html"><a href="tsets.html#tsets:implementation:initialization"><i class="fa fa-check"></i><b>4.5.2</b> Initialization</a></li>
<li class="chapter" data-level="4.5.3" data-path="tsets.html"><a href="tsets.html#tsets:implementation:transformations"><i class="fa fa-check"></i><b>4.5.3</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tsets.html"><a href="tsets.html#tsets:demonstration"><i class="fa fa-check"></i><b>4.6</b> Demonstration</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:specification"><i class="fa fa-check"></i><b>4.6.1</b> The Specification Object</a></li>
<li class="chapter" data-level="4.6.2" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:estimation"><i class="fa fa-check"></i><b>4.6.2</b> Estimation</a></li>
<li class="chapter" data-level="4.6.3" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:prediction"><i class="fa fa-check"></i><b>4.6.3</b> Prediction</a></li>
<li class="chapter" data-level="4.6.4" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:filtering"><i class="fa fa-check"></i><b>4.6.4</b> Filtering</a></li>
<li class="chapter" data-level="4.6.5" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:simulation"><i class="fa fa-check"></i><b>4.6.5</b> Simulation</a></li>
<li class="chapter" data-level="4.6.6" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:profiling"><i class="fa fa-check"></i><b>4.6.6</b> Profiling</a></li>
<li class="chapter" data-level="4.6.7" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:backtesting"><i class="fa fa-check"></i><b>4.6.7</b> Backtesting</a></li>
<li class="chapter" data-level="4.6.8" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:benchmarking"><i class="fa fa-check"></i><b>4.6.8</b> Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tsissm.html"><a href="tsissm.html"><i class="fa fa-check"></i><b>5</b> tsissm package</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tsissm.html"><a href="tsissm.html#tsissm:introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="tsissm.html"><a href="tsissm.html#tsissm:initialization"><i class="fa fa-check"></i><b>5.2</b> State Initialization</a></li>
<li class="chapter" data-level="5.3" data-path="tsissm.html"><a href="tsissm.html#tsissm:likelihood"><i class="fa fa-check"></i><b>5.3</b> Log-Likelihood</a></li>
<li class="chapter" data-level="5.4" data-path="tsissm.html"><a href="tsissm.html#tsissm:implementation"><i class="fa fa-check"></i><b>5.4</b> Package Implementation</a></li>
<li class="chapter" data-level="5.5" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration"><i class="fa fa-check"></i><b>5.5</b> Demonstration</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:specification"><i class="fa fa-check"></i><b>5.5.1</b> Specification</a></li>
<li class="chapter" data-level="5.5.2" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:estimation"><i class="fa fa-check"></i><b>5.5.2</b> Estimation</a></li>
<li class="chapter" data-level="5.5.3" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:prediction"><i class="fa fa-check"></i><b>5.5.3</b> Prediction</a></li>
<li class="chapter" data-level="5.5.4" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:simulation"><i class="fa fa-check"></i><b>5.5.4</b> Simulation</a></li>
<li class="chapter" data-level="5.5.5" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:filtering"><i class="fa fa-check"></i><b>5.5.5</b> Filtering</a></li>
<li class="chapter" data-level="5.5.6" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:profiling"><i class="fa fa-check"></i><b>5.5.6</b> Profiling</a></li>
<li class="chapter" data-level="5.5.7" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:backtesting"><i class="fa fa-check"></i><b>5.5.7</b> Backtesting</a></li>
<li class="chapter" data-level="5.5.8" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:benchmarking"><i class="fa fa-check"></i><b>5.5.8</b> Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tsvets.html"><a href="tsvets.html"><i class="fa fa-check"></i><b>6</b> tsvets package</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:regressors"><i class="fa fa-check"></i><b>6.2</b> Inclusion of External Regressors</a></li>
<li class="chapter" data-level="6.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:likelihood"><i class="fa fa-check"></i><b>6.3</b> Log-Likelihood</a></li>
<li class="chapter" data-level="6.4" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence"><i class="fa fa-check"></i><b>6.4</b> Dependence Structure</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:diagonal"><i class="fa fa-check"></i><b>6.4.1</b> Diagonal Covariance</a></li>
<li class="chapter" data-level="6.4.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:equicorrelation"><i class="fa fa-check"></i><b>6.4.2</b> Equicorrelation</a></li>
<li class="chapter" data-level="6.4.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:shrinkage"><i class="fa fa-check"></i><b>6.4.3</b> Shrinkage Covariance</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="tsvets.html"><a href="tsvets.html#tsvets:grouping"><i class="fa fa-check"></i><b>6.5</b> Grouping and Pooling</a></li>
<li class="chapter" data-level="6.6" data-path="tsvets.html"><a href="tsvets.html#tsvets:homogeneous"><i class="fa fa-check"></i><b>6.6</b> Homogeneous Coefficients and Aggregation</a></li>
<li class="chapter" data-level="6.7" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration"><i class="fa fa-check"></i><b>6.7</b> Demonstration</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:specification"><i class="fa fa-check"></i><b>6.7.1</b> Specification</a></li>
<li class="chapter" data-level="6.7.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example1"><i class="fa fa-check"></i><b>6.7.2</b> Example: Australian Retail Sales</a></li>
<li class="chapter" data-level="6.7.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example2"><i class="fa fa-check"></i><b>6.7.3</b> Example: Australian Retail Sales Grouped Dynamics</a></li>
<li class="chapter" data-level="6.7.4" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example3"><i class="fa fa-check"></i><b>6.7.4</b> Example: Australian Retail Sales Filtering</a></li>
<li class="chapter" data-level="6.7.5" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example4"><i class="fa fa-check"></i><b>6.7.5</b> Example: Australian Retail Sales Aggregation</a></li>
<li class="chapter" data-level="6.7.6" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example6"><i class="fa fa-check"></i><b>6.7.6</b> Example: Groupwise Pooling</a></li>
<li class="chapter" data-level="6.7.7" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example5"><i class="fa fa-check"></i><b>6.7.7</b> Example: Price Volume Aggregation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tsforeign.html"><a href="tsforeign.html"><i class="fa fa-check"></i><b>7</b> tsforeign package</a>
<ul>
<li class="chapter" data-level="7.1" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:arima"><i class="fa fa-check"></i><b>7.2</b> ARIMA model</a></li>
<li class="chapter" data-level="7.3" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:bsts"><i class="fa fa-check"></i><b>7.3</b> bsts model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tscausal.html"><a href="tscausal.html"><i class="fa fa-check"></i><b>8</b> tscausal package</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tscausal.html"><a href="tscausal.html#tscausal:introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="tscausal.html"><a href="tscausal.html#tscausal:evalmeasures"><i class="fa fa-check"></i><b>8.2</b> Measures of Evaluation</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="tscausal.html"><a href="tscausal.html#tscausal:evalmeasures:pointwise"><i class="fa fa-check"></i><b>8.2.1</b> Pointwise Impact</a></li>
<li class="chapter" data-level="8.2.2" data-path="tscausal.html"><a href="tscausal.html#tscausal:evalmeasures:cumulative"><i class="fa fa-check"></i><b>8.2.2</b> Cumulative Impact</a></li>
<li class="chapter" data-level="8.2.3" data-path="tscausal.html"><a href="tscausal.html#tscausal:evalmeasures:meaneffect"><i class="fa fa-check"></i><b>8.2.3</b> Mean Effect</a></li>
<li class="chapter" data-level="8.2.4" data-path="tscausal.html"><a href="tscausal.html#tscausal:evalmeasures:relativeeffect"><i class="fa fa-check"></i><b>8.2.4</b> Mean Relative Effect</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tscausal.html"><a href="tscausal.html#tscausal:significance"><i class="fa fa-check"></i><b>8.3</b> Evaluation of Significance</a></li>
<li class="chapter" data-level="8.4" data-path="tscausal.html"><a href="tscausal.html#tscausl:features"><i class="fa fa-check"></i><b>8.4</b> Package Features</a></li>
<li class="chapter" data-level="8.5" data-path="tscausal.html"><a href="tscausal.html#tscausl:demo"><i class="fa fa-check"></i><b>8.5</b> Package Demo</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tsdistributions.html"><a href="tsdistributions.html"><i class="fa fa-check"></i><b>9</b> tsdistributions package</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:introduction"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions"><i class="fa fa-check"></i><b>9.2</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:norm"><i class="fa fa-check"></i><b>9.2.1</b> The Normal Distribution</a></li>
<li class="chapter" data-level="9.2.2" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:std"><i class="fa fa-check"></i><b>9.2.2</b> The Student Distribution</a></li>
<li class="chapter" data-level="9.2.3" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:ged"><i class="fa fa-check"></i><b>9.2.3</b> The Generalized Error Distribution</a></li>
<li class="chapter" data-level="9.2.4" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:skewed"><i class="fa fa-check"></i><b>9.2.4</b> Skewed Distributions by Inverse Scale Factors</a></li>
<li class="chapter" data-level="9.2.5" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:ghyp"><i class="fa fa-check"></i><b>9.2.5</b> The Generalized Hyperbolic Distribution and Sub-Families</a></li>
<li class="chapter" data-level="9.2.6" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:ghst"><i class="fa fa-check"></i><b>9.2.6</b> The Generalized Hyperbolic Skew Student Distribution</a></li>
<li class="chapter" data-level="9.2.7" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:jsu"><i class="fa fa-check"></i><b>9.2.7</b> Johnson’s reparameterized SU Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:moments"><i class="fa fa-check"></i><b>9.3</b> A note on analytic higher moments</a></li>
<li class="chapter" data-level="9.4" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:code"><i class="fa fa-check"></i><b>9.4</b> Implementation and Code Examples</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="other.html"><a href="other.html"><i class="fa fa-check"></i><b>10</b> Other packages</a></li>
<li class="chapter" data-level="11" data-path="experimental.html"><a href="experimental.html"><i class="fa fa-check"></i><b>11</b> Experimental Functionality</a>
<ul>
<li class="chapter" data-level="11.1" data-path="experimental.html"><a href="experimental.html#calibration-of-predictive-distributions"><i class="fa fa-check"></i><b>11.1</b> Calibration of Predictive Distributions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="experimental.html"><a href="experimental.html#example-coming-soon"><i class="fa fa-check"></i><b>11.1.1</b> Example [Coming Soon]</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="experimental.html"><a href="experimental.html#beyond-box-cox-the-logit-normal-assumption-for-ratios"><i class="fa fa-check"></i><b>11.2</b> Beyond Box-Cox : The Logit-Normal Assumption for Ratios</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="news.html"><a href="news.html"><i class="fa fa-check"></i><b>12</b> News</a></li>
<li class="chapter" data-level="13" data-path="team.html"><a href="team.html"><i class="fa fa-check"></i><b>13</b> The tsmodels team</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Time Series Framework</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tsforeign" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> tsforeign package</h1>
<div id="tsforeign:introduction" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Introduction</h2>
<p>The <strong>tsforeign</strong> package provides custom wrappers for the <code>auto.arima</code> function from the <a href="https://cran.r-project.org/web/packages/forecast/"><strong>forecast</strong></a> package of <span class="citation">R. Hyndman et al. (<a href="#ref-R-forecast" role="doc-biblioref">2022</a>)</span> package and the <code>bsts</code> method from <a href="https://cran.r-project.org/web/packages/bsts/"><strong>bsts</strong></a> package of <span class="citation">Steven L. Scott (<a href="#ref-R-bsts" role="doc-biblioref">2021</a>)</span>, with methods for estimation, some diagnostics and prediction. This package may be extended in future to provide wrappers for other interesting models. For the <code>bsts</code> model, we have also made use of the <code>tsconvert</code> method from the <strong>tsmethods</strong> package to convert the output of the model to one conforming to the required inputs of the <a href="https://cran.r-project.org/web/packages/dlm/"><strong>dlm</strong></a> package, for which we provide an example in the demonstration section.</p>
<p>Since both of those packages have their own vignettes and documentation, we proceed here directly into a demonstration of the functionality.</p>
</div>
<div id="tsforeign:arima" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> ARIMA model</h2>
<p>The entry point for the ARIMA model is the <code>arima_modelspec</code> function</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="tsforeign.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(tsforeign))</span>
<span id="cb199-2"><a href="tsforeign.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb199-3"><a href="tsforeign.html#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsaux)</span>
<span id="cb199-4"><a href="tsforeign.html#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(arima_modelspec)</span></code></pre></div>
<pre><code>## function (y, xreg = NULL, frequency = NULL, seasonal = FALSE, 
##     seasonal_type = &quot;regular&quot;, lambda = NULL, seasonal_harmonics = NULL, 
##     lambda_lower = 0, lambda_upper = 1.5, ...) 
## NULL</code></pre>
<p>which allows for both regular and trigonometric seasonality.</p>
<p>For the demonstration example, we’ll use the <code>AirPassengers</code> dataset after first converting it into an <code>xts</code> object:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="tsforeign.html#cb201-1" aria-hidden="true" tabindex="-1"></a>air <span class="ot">&lt;-</span> AirPassengers</span>
<span id="cb201-2"><a href="tsforeign.html#cb201-2" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">future_dates</span>(<span class="fu">as.Date</span>(<span class="st">&quot;1948-12-31&quot;</span>), <span class="st">&quot;months&quot;</span>, <span class="fu">length</span>(air))</span>
<span id="cb201-3"><a href="tsforeign.html#cb201-3" aria-hidden="true" tabindex="-1"></a>air <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">as.numeric</span>(air), dt)</span>
<span id="cb201-4"><a href="tsforeign.html#cb201-4" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">arima_modelspec</span>(<span class="at">y =</span> air, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">seasonal_type =</span> <span class="st">&quot;regular&quot;</span>, </span>
<span id="cb201-5"><a href="tsforeign.html#cb201-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">seasonal =</span> <span class="cn">TRUE</span>, <span class="at">lambda =</span> <span class="cn">NA</span>)</span>
<span id="cb201-6"><a href="tsforeign.html#cb201-6" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">estimate</span>(spec)</span>
<span id="cb201-7"><a href="tsforeign.html#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code></pre></div>
<pre><code>## ARIMA(0,1,1)(0,1,1)[12] 
## ------------------------ 
##      Estimate Std.Error t value  Pr(&gt;|t|)
## ma1   -0.4018   0.08964  -4.482 7.381e-06
## sma1  -0.5569   0.07310  -7.619 2.554e-14
## 
## sigma : 0.037
## 
##      AIC     BIC    AICc
##  -483.31 -474.69 -483.13
## 
##    MAPE   MASE  MSLRE BIAS
##  0.0262 0.2297 0.0012    0</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="tsforeign.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tsmetrics</span>(mod)</span></code></pre></div>
<pre><code>##     n no.pars   LogLik       AIC       BIC      AICc       MAPE      MASE
## 1 131       2 244.6574 -483.3147 -474.6891 -483.1258 0.02623633 0.2297063
##         MSLRE         BIAS
## 1 0.001228422 4.059721e-05</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="tsforeign.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>The predict function generates a predictive distribution via simulation and returns an object of class <code>tsmodel.predict</code>:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="tsforeign.html#cb206-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb206-2"><a href="tsforeign.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>Additionally, there is also a backtest method:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="tsforeign.html#cb207-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">tsbacktest</span>(spec, <span class="at">h =</span> <span class="dv">12</span>, <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.1</span>), <span class="at">cores =</span> <span class="dv">5</span>, <span class="at">trace =</span> F)</span>
<span id="cb207-2"><a href="tsforeign.html#cb207-2" aria-hidden="true" tabindex="-1"></a>b<span class="sc">$</span>metrics</span></code></pre></div>
<pre><code>##     horizon variable       MAPE        MSLRE        BIAS  n MIS[0.02]  MIS[0.1]
##  1:       1        y 0.02351272 0.0009518386 0.003642628 72  82.21671  58.61296
##  2:       2        y 0.02842487 0.0013739694 0.006228191 71  82.16413  64.03673
##  3:       3        y 0.03297557 0.0018355504 0.008231836 70  91.48748  76.02043
##  4:       4        y 0.03713744 0.0023059782 0.009770361 69 118.31220  86.56444
##  5:       5        y 0.03861585 0.0024731612 0.011633408 68 121.73611  90.79589
##  6:       6        y 0.04170030 0.0027829102 0.013368590 67 129.66725  96.52080
##  7:       7        y 0.04404952 0.0030952798 0.015797297 66 134.56197 100.20819
##  8:       8        y 0.04550001 0.0031856386 0.018678672 65 134.85107 105.00035
##  9:       9        y 0.04689624 0.0033839830 0.020827865 64 141.87493 112.67845
## 10:      10        y 0.04891122 0.0037185732 0.023964482 63 150.98125 117.68297
## 11:      11        y 0.05022460 0.0038974091 0.026173847 62 167.42327 124.23877
## 12:      12        y 0.05267598 0.0041769436 0.027745245 61 168.34366 129.46426</code></pre>
</div>
<div id="tsforeign:bsts" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> bsts model</h2>
<p>The bsts package of <span class="citation">(<a href="#ref-R-bsts" role="doc-biblioref">Steven L. Scott 2021</a>)</span> provides functions for fitting Bayesian structural time series models. The entry point in our wrapper is the <code>bsts_modelspec</code> function:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="tsforeign.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(bsts_modelspec)</span></code></pre></div>
<pre><code>## function (y, xreg = NULL, frequency = NULL, differences = 0, 
##     level = TRUE, slope = TRUE, damped = FALSE, seasonal = FALSE, 
##     seasonal_frequency = 4, ar = FALSE, ar_max = 1, cycle = FALSE, 
##     cycle_frequency = NULL, cycle_names = NULL, seasonal_type = &quot;regular&quot;, 
##     lambda = NULL, lambda_lower = 0, lambda_upper = 1, seasonal_harmonics = NULL, 
##     distribution = &quot;gaussian&quot;, ...) 
## NULL</code></pre>
<p>which provides a rich set of options such as degree of differencing,<a href="references.html#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a> a sparse AR component, sparse regressors, regular or trigonometric seasonal components (including multiple seasonal), cyclical components and the Box Cox transformation. Once an object is estimated, and all required components have been generated, any additional methods on the estimated component are performed directly by custom written functions in the <strong>tsforeign</strong> package.</p>
<p>For the demonstration we’ll use the <code>priceunits</code> dataset from the <strong>tsdatasets</strong> package. Once a series is estimated, the resulting MCMC draws are converted to an <code>mcmc</code> object from the <a href="https://cran.r-project.org/web/packages/coda/"><strong>coda</strong></a> package of <span class="citation">Plummer et al. (<a href="#ref-R-coda" role="doc-biblioref">2020</a>)</span> in order to provide a nice summary report.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="tsforeign.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;priceunits&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tsdatasets&quot;</span>)</span>
<span id="cb211-2"><a href="tsforeign.html#cb211-2" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">bsts_modelspec</span>(<span class="at">y =</span> priceunits[<span class="dv">1</span><span class="sc">:</span><span class="dv">80</span>,<span class="dv">1</span>], <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">differences =</span> <span class="dv">0</span>, </span>
<span id="cb211-3"><a href="tsforeign.html#cb211-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">level =</span> T, <span class="at">slope =</span> T, <span class="at">damped =</span> T, <span class="at">seasonal =</span> T, </span>
<span id="cb211-4"><a href="tsforeign.html#cb211-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_frequency =</span> <span class="dv">12</span>, <span class="at">ar =</span> T, <span class="at">ar_max =</span> <span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb211-5"><a href="tsforeign.html#cb211-5" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">estimate</span>(spec, <span class="at">n_iter =</span> <span class="dv">2000</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb211-6"><a href="tsforeign.html#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:2000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 2000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##                       Mean       SD  Naive SE Time-series SE Prob[Include]
## obs.sigma         0.013447 0.006681 1.494e-04      0.0007623        1.0000
## level.sigma       0.006378 0.005576 1.247e-04      0.0022445        1.0000
## slope.sigma       0.032448 0.005898 1.319e-04      0.0003741        1.0000
## slope.ar         -0.414833 0.228498 5.109e-03      0.0172160        1.0000
## seasonal12.sigma  0.002133 0.002324 5.196e-05      0.0008118        1.0000
## ar1               0.109337 0.286711 6.411e-03      0.0255973        0.7325
## ar2               0.056231 0.144130 3.223e-03      0.0105370        0.4460
## ar3               0.005568 0.052553 1.175e-03      0.0021716        0.2265
## ar3.sigma         0.028778 0.006173 1.380e-04      0.0003585        1.0000
## 
## 2. Quantiles for each variable:
## 
##                        2.5%        25%       50%       75%    97.5%
## obs.sigma         0.0056653  0.0097693  0.012631  0.016037 0.024047
## level.sigma       0.0003059  0.0016572  0.004478  0.009796 0.019283
## slope.sigma       0.0216738  0.0284273  0.032392  0.036309 0.044726
## slope.ar         -0.7962351 -0.5742976 -0.435251 -0.286294 0.116079
## seasonal12.sigma  0.0001700  0.0005653  0.001372  0.002788 0.009231
## ar1              -0.3957427  0.0000000  0.000000  0.265122 0.811486
## ar2              -0.1478458  0.0000000  0.000000  0.072287 0.453222
## ar3              -0.0956724  0.0000000  0.000000  0.000000 0.142205
## ar3.sigma         0.0208546  0.0252688  0.028345  0.031507 0.038554
## 
## 
## Harvey&#39;s Goodness of Fit Statistic: 0.214599 
## 
##    MAPE  MASE  MSLRE   BIAS
##  0.0372 0.471 0.0023 -3e-04</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="tsforeign.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tsmetrics</span>(mod)</span></code></pre></div>
<pre><code>##    n no.pars       MAPE      MASE       MSLRE          BIAS
## 1 80       9 0.03719672 0.4710402 0.002286337 -0.0003182284</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="tsforeign.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/unnamed-chunk-44-1.png" width="768" /></p>
<p>The decomposition of the model into it’s fitted components is done via the <code>tsdecompose</code> method. However, note that the bsts routine returns the smoothed component states, not the filtered ones.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="tsforeign.html#cb216-1" aria-hidden="true" tabindex="-1"></a>tde <span class="ot">&lt;-</span> <span class="fu">tsdecompose</span>(mod)</span>
<span id="cb216-2"><a href="tsforeign.html#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="co"># distribution objects of state components</span></span>
<span id="cb216-3"><a href="tsforeign.html#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tde)</span></code></pre></div>
<pre><code>## List of 5
##  $ Level     : &#39;tsmodel.distribution&#39; num [1:1951, 1:80] 1.58 1.64 1.58 1.59 1.6 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:80] &quot;1992-08-31&quot; &quot;1992-09-30&quot; &quot;1992-10-31&quot; &quot;1992-11-30&quot; ...
##   ..- attr(*, &quot;date_class&quot;)= chr &quot;Date&quot;
##  $ Slope     : &#39;tsmodel.distribution&#39; num [1:1951, 1:80] 0.06293 -0.03108 0.00991 0.04527 0.02463 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:80] &quot;1992-08-31&quot; &quot;1992-09-30&quot; &quot;1992-10-31&quot; &quot;1992-11-30&quot; ...
##   ..- attr(*, &quot;date_class&quot;)= chr &quot;Date&quot;
##  $ AR        : &#39;tsmodel.distribution&#39; num [1:1951, 1:80] 0.04046 0.01669 0.04409 0.04805 0.00863 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:80] &quot;1992-08-31&quot; &quot;1992-09-30&quot; &quot;1992-10-31&quot; &quot;1992-11-30&quot; ...
##   ..- attr(*, &quot;date_class&quot;)= chr &quot;Date&quot;
##  $ X         : NULL
##  $ Seasonal12: &#39;tsmodel.distribution&#39; num [1:1951, 1:80] -0.0468 -0.0777 -0.0584 -0.0539 -0.0509 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:80] &quot;1992-08-31&quot; &quot;1992-09-30&quot; &quot;1992-10-31&quot; &quot;1992-11-30&quot; ...
##   ..- attr(*, &quot;date_class&quot;)= chr &quot;Date&quot;</code></pre>
<p>Once bsts model is estimated, we can convert it to a <code>dlm</code> object<a href="references.html#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> using either the mean values of the parameters and initial states, or a specific draw using the <code>tsconvert</code> method.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="tsforeign.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dlm)</span>
<span id="cb218-2"><a href="tsforeign.html#cb218-2" aria-hidden="true" tabindex="-1"></a>dlm_model <span class="ot">&lt;-</span> <span class="fu">tsconvert</span>(mod, <span class="at">to =</span> <span class="st">&quot;dlm&quot;</span>, <span class="at">draw =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb218-3"><a href="tsforeign.html#cb218-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">burn =</span> bsts<span class="sc">::</span><span class="fu">SuggestBurn</span>(<span class="fl">0.1</span>, mod<span class="sc">$</span>model))</span>
<span id="cb218-4"><a href="tsforeign.html#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dlm_model)</span></code></pre></div>
<pre><code>## List of 6
##  $ m0: num [1:17] 1.56726 0.01697 -0.00441 -0.04056 -0.03051 ...
##  $ C0: num [1:17, 1:17] 1e+07 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 0e+00 ...
##  $ FF: num [1, 1:17] 1 0 0 1 0 0 0 0 0 0 ...
##  $ V : num [1, 1] 0.013
##  $ GG: num [1:17, 1:17] 1 0 0 0 0 0 0 0 0 0 ...
##  $ W : num [1:17, 1:17] 0.00652 0 0 0 0 ...
##  - attr(*, &quot;class&quot;)= chr &quot;dlm&quot;</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="tsforeign.html#cb220-1" aria-hidden="true" tabindex="-1"></a>filtered_dlm <span class="ot">&lt;-</span> <span class="fu">dlmFilter</span>(<span class="fu">log</span>(priceunits[<span class="dv">1</span><span class="sc">:</span><span class="dv">80</span>,<span class="dv">1</span>]), dlm_model)</span>
<span id="cb220-2"><a href="tsforeign.html#cb220-2" aria-hidden="true" tabindex="-1"></a>smoothed_dlm <span class="ot">&lt;-</span> <span class="fu">dlmSmooth</span>(filtered_dlm)</span>
<span id="cb220-3"><a href="tsforeign.html#cb220-3" aria-hidden="true" tabindex="-1"></a>smoothed_series <span class="ot">&lt;-</span> <span class="fu">xts</span>((dlm_model<span class="sc">$</span>FF <span class="sc">%*%</span> <span class="fu">t</span>(smoothed_dlm<span class="sc">$</span>s))[<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>], <span class="fu">index</span>(priceunits)[<span class="dv">1</span><span class="sc">:</span><span class="dv">80</span>])</span>
<span id="cb220-4"><a href="tsforeign.html#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb220-5"><a href="tsforeign.html#cb220-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(filtered_dlm<span class="sc">$</span>f), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Filtered Series&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb220-6"><a href="tsforeign.html#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.zoo</span>(<span class="fu">fitted</span>(mod, <span class="at">raw =</span> <span class="cn">TRUE</span>)), <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb220-7"><a href="tsforeign.html#cb220-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb220-8"><a href="tsforeign.html#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;DLM&quot;</span>,<span class="st">&quot;BSTS&quot;</span>), <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb220-9"><a href="tsforeign.html#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(smoothed_series), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Smoothed Series&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb220-10"><a href="tsforeign.html#cb220-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">as.zoo</span>(<span class="fu">fitted</span>(mod, <span class="at">raw =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">&quot;smoothed&quot;</span>)), <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb220-11"><a href="tsforeign.html#cb220-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb220-12"><a href="tsforeign.html#cb220-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;DLM&quot;</span>,<span class="st">&quot;BSTS&quot;</span>), <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>We compare the predictive distribution of the predicted object from calling the predict method of the <strong>tsforeign</strong> package and that of the <a href="https://cran.r-project.org/web/packages/bsts/"><strong>bsts</strong></a> package. Note that there are a lot more arguments which can be passed to the <code>predict</code> routine, including user overrides for the last state means and the posterior means of the parameters (see the documentation for more details).</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="tsforeign.html#cb221-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb221-2"><a href="tsforeign.html#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="co"># BSTS method</span></span>
<span id="cb221-3"><a href="tsforeign.html#cb221-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> bsts<span class="sc">::</span><span class="fu">predict.bsts</span>(mod<span class="sc">$</span>model, <span class="at">horizon =</span> <span class="dv">12</span>)</span>
<span id="cb221-4"><a href="tsforeign.html#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert predictive distribution to tsmodel.distribution for comparison</span></span>
<span id="cb221-5"><a href="tsforeign.html#cb221-5" aria-hidden="true" tabindex="-1"></a>p2d <span class="ot">&lt;-</span> p2<span class="sc">$</span>distribution</span>
<span id="cb221-6"><a href="tsforeign.html#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(p2d) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(p1<span class="sc">$</span>distribution)</span>
<span id="cb221-7"><a href="tsforeign.html#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(p2d) <span class="ot">&lt;-</span> <span class="st">&quot;tsmodel.distribution&quot;</span></span>
<span id="cb221-8"><a href="tsforeign.html#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(p1<span class="sc">$</span>distribution), <span class="at">main =</span> <span class="st">&quot;tsforeign native predict c++ routine vs bsts routine&quot;</span>)</span>
<span id="cb221-9"><a href="tsforeign.html#cb221-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p2d, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">median_color =</span> <span class="dv">2</span>, <span class="at">interval_color =</span> <span class="dv">2</span>, <span class="at">median_type =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>A predicted object can also be decomposed into it’s structural components, something we are able to do because of the custom predict routine since <code>bsts</code> does not return this information.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="tsforeign.html#cb222-1" aria-hidden="true" tabindex="-1"></a>td <span class="ot">&lt;-</span> <span class="fu">tsdecompose</span>(p1)</span>
<span id="cb222-2"><a href="tsforeign.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb222-3"><a href="tsforeign.html#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(td<span class="sc">$</span>Level, <span class="at">main =</span> <span class="st">&quot;Level&quot;</span>)</span>
<span id="cb222-4"><a href="tsforeign.html#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(td<span class="sc">$</span>Slope, <span class="at">main =</span> <span class="st">&quot;Slope&quot;</span>)</span>
<span id="cb222-5"><a href="tsforeign.html#cb222-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(td<span class="sc">$</span>Seasonal12, <span class="at">main =</span> <span class="st">&quot;Seasonal&quot;</span>)</span>
<span id="cb222-6"><a href="tsforeign.html#cb222-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(td<span class="sc">$</span>AR, <span class="at">main =</span> <span class="st">&quot;AR&quot;</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/unnamed-chunk-48-1.png" width="768" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-forecast" class="csl-entry">
Hyndman, Rob, George Athanasopoulos, Christoph Bergmeir, Gabriel Caceres, Leanne Chhay, Mitchell O’Hara-Wild, Fotios Petropoulos, Slava Razbash, Earo Wang, and Farah Yasmeen. 2022. <em>Forecast: Forecasting Functions for Time Series and Linear Models</em>. <a href="https://CRAN.R-project.org/package=forecast">https://CRAN.R-project.org/package=forecast</a>.
</div>
<div id="ref-R-coda" class="csl-entry">
Plummer, Martyn, Nicky Best, Kate Cowles, Karen Vines, Deepayan Sarkar, Douglas Bates, Russell Almond, and Arni Magnusson. 2020. <em>Coda: Output Analysis and Diagnostics for MCMC</em>. <a href="https://CRAN.R-project.org/package=coda">https://CRAN.R-project.org/package=coda</a>.
</div>
<div id="ref-R-bsts" class="csl-entry">
Scott, Steven L. 2021. <em>Bsts: Bayesian Structural Time Series</em>. <a href="https://CRAN.R-project.org/package=bsts">https://CRAN.R-project.org/package=bsts</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tsvets.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tscausal.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
