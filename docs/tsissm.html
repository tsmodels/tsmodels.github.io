<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 tsissm package | A Time Series Framework</title>
  <meta name="description" content="Documentation for the tsmodels framework" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 tsissm package | A Time Series Framework" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Documentation for the tsmodels framework" />
  <meta name="github-repo" content="tsmodels/tsmodels.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 tsissm package | A Time Series Framework" />
  
  <meta name="twitter:description" content="Documentation for the tsmodels framework" />
  

<meta name="author" content="The tsmodels team" />


<meta name="date" content="2020-09-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tsets.html"/>
<link rel="next" href="tsvets.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-177357579-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  
  function gtag(){dataLayer.push(arguments);}
  
  gtag('js', new Date());
  
  gtag('config', 'UA-177357579-1');
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series Forecasting Framework</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Installation</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="tsmethods.html"><a href="tsmethods.html"><i class="fa fa-check"></i><b>3</b> tsmethods package</a><ul>
<li class="chapter" data-level="3.1" data-path="tsmethods.html"><a href="tsmethods.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="tsmethods.html"><a href="tsmethods.html#tsmethods:simulation"><i class="fa fa-check"></i><b>3.2</b> Ensembling Forecast Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="tsmethods.html"><a href="tsmethods.html#demonstration"><i class="fa fa-check"></i><b>3.3</b> Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tsets.html"><a href="tsets.html"><i class="fa fa-check"></i><b>4</b> tsets package</a><ul>
<li class="chapter" data-level="4.1" data-path="tsets.html"><a href="tsets.html#tsets:intro"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="tsets.html"><a href="tsets.html#tsets:taxonomy"><i class="fa fa-check"></i><b>4.2</b> Taxonomy of Models</a></li>
<li class="chapter" data-level="4.3" data-path="tsets.html"><a href="tsets.html#tsets:extensions"><i class="fa fa-check"></i><b>4.3</b> Extensions</a></li>
<li class="chapter" data-level="4.4" data-path="tsets.html"><a href="tsets.html#some-encompasing-alternatives"><i class="fa fa-check"></i><b>4.4</b> Some Encompasing Alternatives</a></li>
<li class="chapter" data-level="4.5" data-path="tsets.html"><a href="tsets.html#tsets:implementation"><i class="fa fa-check"></i><b>4.5</b> Package Implementation</a><ul>
<li class="chapter" data-level="4.5.1" data-path="tsets.html"><a href="tsets.html#tsets:implementation:constraints"><i class="fa fa-check"></i><b>4.5.1</b> Constraints</a></li>
<li class="chapter" data-level="4.5.2" data-path="tsets.html"><a href="tsets.html#tsets:implementation:initialization"><i class="fa fa-check"></i><b>4.5.2</b> Initialization</a></li>
<li class="chapter" data-level="4.5.3" data-path="tsets.html"><a href="tsets.html#tsets:implementation:transformations"><i class="fa fa-check"></i><b>4.5.3</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tsets.html"><a href="tsets.html#tsets:demonstration"><i class="fa fa-check"></i><b>4.6</b> Demonstration</a><ul>
<li class="chapter" data-level="4.6.1" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:specification"><i class="fa fa-check"></i><b>4.6.1</b> The Specification Object</a></li>
<li class="chapter" data-level="4.6.2" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:estimation"><i class="fa fa-check"></i><b>4.6.2</b> Estimation</a></li>
<li class="chapter" data-level="4.6.3" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:prediction"><i class="fa fa-check"></i><b>4.6.3</b> Prediction</a></li>
<li class="chapter" data-level="4.6.4" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:filtering"><i class="fa fa-check"></i><b>4.6.4</b> Filtering</a></li>
<li class="chapter" data-level="4.6.5" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:simulation"><i class="fa fa-check"></i><b>4.6.5</b> Simulation</a></li>
<li class="chapter" data-level="4.6.6" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:profiling"><i class="fa fa-check"></i><b>4.6.6</b> Profiling</a></li>
<li class="chapter" data-level="4.6.7" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:backtesting"><i class="fa fa-check"></i><b>4.6.7</b> Backtesting</a></li>
<li class="chapter" data-level="4.6.8" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:benchmarking"><i class="fa fa-check"></i><b>4.6.8</b> Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tsissm.html"><a href="tsissm.html"><i class="fa fa-check"></i><b>5</b> tsissm package</a><ul>
<li class="chapter" data-level="5.1" data-path="tsissm.html"><a href="tsissm.html#tsissm:introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="tsissm.html"><a href="tsissm.html#tsissm:initialization"><i class="fa fa-check"></i><b>5.2</b> State Initialization</a></li>
<li class="chapter" data-level="5.3" data-path="tsissm.html"><a href="tsissm.html#tsissm:likelihood"><i class="fa fa-check"></i><b>5.3</b> Log-Likelihood</a></li>
<li class="chapter" data-level="5.4" data-path="tsissm.html"><a href="tsissm.html#tsissm:implementation"><i class="fa fa-check"></i><b>5.4</b> Package Implementation</a></li>
<li class="chapter" data-level="5.5" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration"><i class="fa fa-check"></i><b>5.5</b> Demonstration</a><ul>
<li class="chapter" data-level="5.5.1" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:specification"><i class="fa fa-check"></i><b>5.5.1</b> Specification</a></li>
<li class="chapter" data-level="5.5.2" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:estimation"><i class="fa fa-check"></i><b>5.5.2</b> Estimation</a></li>
<li class="chapter" data-level="5.5.3" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:prediction"><i class="fa fa-check"></i><b>5.5.3</b> Prediction</a></li>
<li class="chapter" data-level="5.5.4" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:simulation"><i class="fa fa-check"></i><b>5.5.4</b> Simulation</a></li>
<li class="chapter" data-level="5.5.5" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:filtering"><i class="fa fa-check"></i><b>5.5.5</b> Filtering</a></li>
<li class="chapter" data-level="5.5.6" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:profiling"><i class="fa fa-check"></i><b>5.5.6</b> Profiling</a></li>
<li class="chapter" data-level="5.5.7" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:backtesting"><i class="fa fa-check"></i><b>5.5.7</b> Backtesting</a></li>
<li class="chapter" data-level="5.5.8" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:benchmarking"><i class="fa fa-check"></i><b>5.5.8</b> Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tsvets.html"><a href="tsvets.html"><i class="fa fa-check"></i><b>6</b> tsvets package</a><ul>
<li class="chapter" data-level="6.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:regressors"><i class="fa fa-check"></i><b>6.2</b> Inclusion of External Regressors</a></li>
<li class="chapter" data-level="6.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:likelihood"><i class="fa fa-check"></i><b>6.3</b> Log-Likelihood</a></li>
<li class="chapter" data-level="6.4" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence"><i class="fa fa-check"></i><b>6.4</b> Dependence Structure</a><ul>
<li class="chapter" data-level="6.4.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:diagonal"><i class="fa fa-check"></i><b>6.4.1</b> Diagonal Covariance</a></li>
<li class="chapter" data-level="6.4.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:equicorrelation"><i class="fa fa-check"></i><b>6.4.2</b> Equicorrelation</a></li>
<li class="chapter" data-level="6.4.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:shrinkage"><i class="fa fa-check"></i><b>6.4.3</b> Shrinkage Covariance</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="tsvets.html"><a href="tsvets.html#tsvets:grouping"><i class="fa fa-check"></i><b>6.5</b> Grouping and Pooling</a></li>
<li class="chapter" data-level="6.6" data-path="tsvets.html"><a href="tsvets.html#tsvets:homogeneous"><i class="fa fa-check"></i><b>6.6</b> Homogeneous Coefficients and Aggregation</a></li>
<li class="chapter" data-level="6.7" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration"><i class="fa fa-check"></i><b>6.7</b> Demonstration</a><ul>
<li class="chapter" data-level="6.7.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:specification"><i class="fa fa-check"></i><b>6.7.1</b> Specification</a></li>
<li class="chapter" data-level="6.7.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example1"><i class="fa fa-check"></i><b>6.7.2</b> Example: Australian Retail Sales</a></li>
<li class="chapter" data-level="6.7.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example2"><i class="fa fa-check"></i><b>6.7.3</b> Example: Australian Retail Sales Grouped Dynamics</a></li>
<li class="chapter" data-level="6.7.4" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example3"><i class="fa fa-check"></i><b>6.7.4</b> Example: Australian Retail Sales Filtering</a></li>
<li class="chapter" data-level="6.7.5" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example4"><i class="fa fa-check"></i><b>6.7.5</b> Example: Australian Retail Sales Aggregation</a></li>
<li class="chapter" data-level="6.7.6" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example5"><i class="fa fa-check"></i><b>6.7.6</b> Example: Price Volume Aggregation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tsforeign.html"><a href="tsforeign.html"><i class="fa fa-check"></i><b>7</b> tsforeign package</a><ul>
<li class="chapter" data-level="7.1" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:arima"><i class="fa fa-check"></i><b>7.2</b> ARIMA model</a></li>
<li class="chapter" data-level="7.3" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:bsts"><i class="fa fa-check"></i><b>7.3</b> bsts model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="other.html"><a href="other.html"><i class="fa fa-check"></i><b>8</b> Other packages</a></li>
<li class="chapter" data-level="9" data-path="team.html"><a href="team.html"><i class="fa fa-check"></i><b>9</b> The tsmodels team</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Time Series Framework</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tsissm" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> tsissm package</h1>
<div id="tsissm:introduction" class="section level2">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p>The <strong>tsissm</strong> package implements the linear (and homoscedastic) innovations state space model described in <span class="citation">De Livera, Hyndman, and Snyder (<a href="#ref-de2011forecasting" role="doc-biblioref">2011</a>)</span> and originally proposed by <span class="citation">Anderson and Moore (<a href="#ref-anderson2012optimal" role="doc-biblioref">2012</a>)</span>. It is in some ways similar to the ETS based models described in <span class="citation">R. Hyndman et al. (<a href="#ref-hyndman2008" role="doc-biblioref">2008</a>)</span>, but with the flexibility of incorporating multiple seasonality, ARMA terms and joint maximization of the Box Cox variance stabilizing lambda parameter.</p>
<p>The following is taken from <span class="citation">De Livera, Hyndman, and Snyder (<a href="#ref-de2011forecasting" role="doc-biblioref">2011</a>)</span>. Consider the following SEM model:</p>
<p><span class="math display" id="eq:tsissm1">\[\begin{equation}
\begin{array}{l}
y_t^\lambda  = {\bf{w&#39;}}{{\bf{x}}_{t - 1}} + \bf{c&#39;}\bf{u}_{t - 1}  + {\varepsilon _t}, \quad \varepsilon_t\sim N\left(0,\sigma^2\right),\\
{{\bf{x}}_t} = {\bf{F}}{{\bf{x}}_{t - 1}} + {\bf{g}}{\varepsilon _t},
\end{array}
\tag{5.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> represents the Box Cox parameter, <span class="math inline">\(\bf{w}\)</span> the observation coefficient vector, <span class="math inline">\(\bf{x}_t\)</span> the unobserved state vector, <span class="math inline">\(\bf{c}\)</span> a vector of coefficients on the external regressor set <span class="math inline">\(\bf{u}\)</span>.</p>
<p>Define the state vector<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> as:</p>
<p><span class="math display" id="eq:tsissm2">\[\begin{equation}
\bf{x}_t = {\left( {{l_t},{b_t},s_t^{(1)},\dots,s_t^{(T)},{d_t},{d_{t - 1}},\dots,{d_{t - p - 1}},{\varepsilon_t},{\varepsilon_{t - 1}},\dots,{\varepsilon _{t - q - 1}}} \right)^\prime },
\tag{5.2}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\bf{s}_t^{(i)}\)</span> is the row vector <span class="math inline">\(\left( {s_{1,t}^{(i)},s_{2,t}^{(i)},\dots,s_{{k_i},t}^{(i)},s_{1,t}^{*(i)},s_{2,t}^{*(i)},\dots,s_{{k_i},t}^{*(i)}} \right)\)</span> in the case of trigonometric seasonality, and <span class="math inline">\(\left( {s_t^{(i)},s_{t - 1}^{(i)},\dots,s_{t - ({m_i} - 1)}^{(i)}} \right)\)</span> in the case of regular seasonality. Also define <span class="math inline">\(\bf{1}_r\)</span> and <span class="math inline">\(\bf{0}_r\)</span> as a vector of ones and zeros, respectively, of length <span class="math inline">\(r\)</span>, <span class="math inline">\(\bf{O}_{u,v}\)</span> a <span class="math inline">\(u\times v\)</span> matrix of zeros and <span class="math inline">\(\bf{I}_{u,v}\)</span> a <span class="math inline">\(u\times v\)</span> diagonal matrix of ones; let <span class="math inline">\(\mathbf{\gamma} = \left(\mathbf{\gamma}^{(1)},\dots,\mathbf{\gamma}^{(T)} \right)\)</span> be a vector of seasonal parameters with <span class="math inline">\({\gamma ^{(i)}} = \left( {\gamma _1^{(i)}{{\bf{1}}_{{k_i}}},\gamma _2^{(i)}{{\bf{1}}_{{k_i}}}} \right)\)</span> in the trigonometric seasonality case (with <span class="math inline">\(k\)</span> harmonics), and <span class="math inline">\({\gamma ^{(i)}} = \left( {{\gamma _i},{{\bf{0}}_{{m_i} - 1}}} \right)\)</span> in the regular seasonality case; define <span class="math inline">\(\theta = \left( {{\theta_1},{\theta_2},\dots,{\theta _p}} \right)\)</span> and <span class="math inline">\(\psi = \left( {{\psi _1},{\psi _2},\dots,{\psi_q}} \right)\)</span> as the vector of AR(p) and MA(q) parameters, respectively.
Define the observation transition vector <span class="math inline">\({\bf{w}} = {\left( {1,\phi ,{\bf{a}},\theta ,\psi } \right)^\prime }\)</span>, where <span class="math inline">\({\bf{a}} = \left( {{{\bf{a}}^{(1)}},\dots,{{\bf{a}}^{(T)}}} \right)\)</span> with <span class="math inline">\({{\bf{a}}^{(i)}} = \left( {{{\bf{1}}_{{k_i}}},{{\bf{0}}_{{k_i}}}} \right)\)</span> for the trigonometric case and <span class="math inline">\({{\bf{a}}^{(i)}} = \left( {{{\bf{0}}_{{m_i} - 1}},1} \right)\)</span> for the regular seasonality case. Define the state error adjustment vector <span class="math inline">\({\bf{g}} = {\left( {\alpha ,\beta ,\gamma ,1,{{\bf{0}}_{p - 1}},1,{{\bf{0}}_{q - 1}}} \right)^\prime }\)</span>. Further, let <span class="math inline">\({\bf{B}} = \gamma &#39;\theta\)</span>, <span class="math inline">\({\bf{C}} = \gamma &#39;\psi\)</span> and <span class="math inline">\({\bf{A}} = \oplus _{i = 1}^T{{\bf{A}}_i}\)</span>, with</p>
<p><span class="math display" id="eq:tsissm3">\[\begin{equation}
{{\bf{A}}_i} = \left[ {\begin{array}{*{20}{c}}
{{{\bf{C}}^{(i)}}}&amp;{{{\bf{S}}^{(i)}}}\\
{ - {{\bf{S}}^{(i)}}}&amp;{{{\bf{C}}^{(i)}}}
\end{array}} \right],
\tag{5.3}
\end{equation}\]</span></p>
<p>for the trigonometric case and with <span class="math inline">\(\bf{C}^{(i)}\)</span> and <span class="math inline">\(\bf{S}^{(i)}\)</span> representing the <span class="math inline">\(k_i\times k_i\)</span> diagonal matrices with elements <span class="math inline">\(cos(\lambda_j^{(i)})\)</span> and <span class="math inline">\(sin(\lambda_j^{(i)})\)</span> respectively,<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> and</p>
<p><span class="math display" id="eq:tsissm4">\[\begin{equation}
{{\bf{A}}_i} = \left[ {\begin{array}{*{20}{c}}
{{{\bf{0}}_{{m_i} - 1}}}&amp;1\\
{{{\bf{I}}_{{m_i} - 1}}}&amp;{{{{\bf{0&#39;}}}_{{m_i} - 1}}}
\end{array}} \right],
\tag{5.4}
\end{equation}\]</span></p>
<p>for the regular seasonality case, with <span class="math inline">\(\oplus\)</span> being the direct sum of matrices operator. Finally, the state transition matrix <span class="math inline">\(\bf{F}\)</span> is composed as follows:</p>
<p><span class="math display" id="eq:tsissm5">\[\begin{equation}
{\bf{F}} = \left[ {\begin{array}{*{20}{c}}
1&amp;\phi &amp;{{{\bf{0}}_\tau }}&amp;{\alpha \theta }&amp;{\alpha \psi }\\
0&amp;\phi &amp;{{{\bf{0}}_\tau }}&amp;{\beta \theta }&amp;{\beta \psi }\\
{{{{\bf{0&#39;}}}_\tau }}&amp;{{{{\bf{0&#39;}}}_\tau }}&amp;{\bf{A}}&amp;{\bf{B}}&amp;{\bf{C}}\\
0&amp;0&amp;{{{\bf{0}}_\tau }}&amp;\theta &amp;\psi \\
{{{{\bf{0&#39;}}}_{p - 1}}}&amp;{{{{\bf{0&#39;}}}_{p - 1}}}&amp;{{{\bf{O}}_{p - 1,\tau }}}&amp;{{{\bf{I}}_{p - 1,p}}}&amp;{{{\bf{O}}_{p - 1,q}}}\\
0&amp;0&amp;{{{\bf{0}}_\tau }}&amp;{{{\bf{0}}_p}}&amp;{{{\bf{0}}_q}}\\
{{{{\bf{0&#39;}}}_{q - 1}}}&amp;{{{{\bf{0&#39;}}}_{q - 1}}}&amp;{{{\bf{O}}_{q - 1,\tau }}}&amp;{{{\bf{O}}_{q - 1,p}}}&amp;{{{\bf{I}}_{q - 1,q}}}
\end{array}} \right]
\tag{5.5}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\tau = 2\sum\limits_{i = 1}^T {{k_i}}\)</span> for the trigonometric case and <span class="math inline">\(\tau = \sum\limits_{i = 1}^T {{m_i}}\)</span> for the regular seasonality case.</p>
</div>
<div id="tsissm:initialization" class="section level2">
<h2><span class="header-section-number">5.2</span> State Initialization</h2>
<p>A key innovation of the <span class="citation">De Livera, Hyndman, and Snyder (<a href="#ref-de2011forecasting" role="doc-biblioref">2011</a>)</span> paper is providing the exact initialization of the non-stationary component’s seed states, the exponential smoothing analogue of the <span class="citation">De Jong and others (<a href="#ref-de1991diffuse" role="doc-biblioref">1991</a>)</span> method for augmenting the Kalman filter to handle seed states with infinite variances. The proof, based on <span class="citation">De Livera, Hyndman, and Snyder (<a href="#ref-de2011forecasting" role="doc-biblioref">2011</a>)</span> and expanded here is as follows:</p>
<p>Let:</p>
<p><span class="math display" id="eq:tsissm6">\[\begin{equation}
{\bf{D}} = {\bf{F}} - {\bf{gw&#39;}}.
\tag{5.6}
\end{equation}\]</span></p>
<p>We eliminate <span class="math inline">\(\varepsilon_t\)</span> in <a href="tsissm.html#eq:tsissm1">(5.1)</a> to give:</p>
<p><span class="math display" id="eq:tsissm7">\[\begin{equation}
{{\bf{x}}_t} = {\bf{D}}{{\bf{x}}_{t - 1}} + {\bf{g}}{y_t}.
\tag{5.7}
\end{equation}\]</span></p>
<p>Next, we proceed by backsolving the equation for the error, given a given value of <span class="math inline">\(\lambda\)</span>:<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a></p>
<p><span class="math display" id="eq:tsissm8">\[\begin{equation}
\begin{array}{l}
{\varepsilon _t} = {y_t} - {\bf{w}}{{{\bf{\hat x}}}_{t - 1}},\\
{\varepsilon _t} = {y_t} - {\bf{w&#39;}}\left( {{\bf{D}}{{{\bf{\hat x}}}_{t - 2}} + {\bf{g}}{y_{t - 1}}} \right).
\end{array}
\tag{5.8}
\end{equation}\]</span></p>
<p>Starting with <span class="math inline">\(t = 4\)</span> and working backwards:</p>
<p><span class="math display" id="eq:tsissm9">\[\begin{equation}
\begin{array}{l}
{\varepsilon _4} &amp;= {y_4} - {\bf{w&#39;}}\left( {{\bf{D}}{{{\bf{\hat x}}}_2} + {\bf{g}}{y_3}} \right)\\
 &amp;= {y_4} - {\bf{w&#39;}}\left( {{\bf{D}}\left( {{\bf{D}}{{{\bf{\hat x}}}_1} + {\bf{g}}{y_2}} \right) + {\bf{g}}{y_3}} \right)\\
 &amp;= {y_4} - {\bf{w&#39;}}\left( {{\bf{D}}\left( {{\bf{D}}\left( {{\bf{D}}{{{\bf{\hat x}}}_0} + {\bf{g}}{y_1}} \right) + {\bf{g}}{y_2}} \right) + {\bf{g}}{y_3}} \right)\\
 &amp;= {y_4} - {\bf{w&#39;}}\left( {{\bf{D}}\left( {{{\bf{D}}^2}{{\bf{x}}_0} + {\bf{Dg}}{y_1} + {\bf{g}}{y_2}} \right) + {\bf{g}}{y_3}} \right)\\
 &amp;= {y_4} - {\bf{w&#39;}}\left( {{{\bf{D}}^3}{{\bf{x}}_0} + {{\bf{D}}^2}{\bf{g}}{y_1} + {\bf{Dg}}{y_2} + {\bf{g}}{y_3}} \right)\\
 &amp;= {y_4} - {\bf{w&#39;}}\sum\limits_{j = 1}^3 {{{\bf{D}}^{j - 1}}{\bf{g}}{y_{4 - j}} - {\bf{w&#39;}}{{\bf{D}}^3}{{\bf{x}}_0}} \\
\end{array}
\tag{5.9}
\end{equation}\]</span></p>
<p>and generalizing to <span class="math inline">\(\varepsilon_t\)</span>:</p>
<p><span class="math display" id="eq:tsissm10">\[\begin{equation}
\begin{array}{l}
{\varepsilon _t} &amp;= {y_t} - {\bf{w&#39;}}\left( {\sum\limits_{j = 1}^{t - 1} {{{\bf{D}}^{j - 1}}{\bf{g}}{y_{t - j}}} } \right) - {\bf{w&#39;}}{{\bf{D}}^{t - 1}}{{\bf{x}}_0}\\
 &amp;= {y_t} - {\bf{w&#39;}}{{{\bf{\tilde x}}}_{t - 1}} - {{{\bf{w&#39;}}}_{t - 1}}{{\bf{x}}_0}\\
 &amp;= {{\tilde y}_t} - {{{\bf{w&#39;}}}_{t - 1}}{{\bf{x}}_0},
\end{array}
\tag{5.10}
\end{equation}\]</span></p>
<p>where <span class="math inline">\({{\tilde y}_t} = {y_t} - {\bf{w&#39;}}{{{\bf{\tilde x}}}_{t - 1}}\)</span>, <span class="math inline">\({{{\bf{\tilde x}}}_t} = {\bf{D}}{{{\bf{\tilde x}}}_{t - 1}} + {\bf{g}}{y_t}\)</span>, <span class="math inline">\({{{\bf{w&#39;}}}_t} = {\bf{D}}{{{\bf{w&#39;}}}_{t - 1}}\)</span>, <span class="math inline">\({{{\bf{\tilde x}}}_0} = 0\)</span> and <span class="math inline">\({{{\bf{w&#39;}}}_0} = {\bf{w&#39;}}\)</span>, so that <span class="math inline">\(\bf{x}_0\)</span> are the coefficients from the regression of <span class="math inline">\(\bf{w}\)</span> on <span class="math inline">\(\boldsymbol{\varepsilon}\)</span>. While this approach bypasses the need to estimate the initial states by augmenting the parameter vector, which could be very costly for multiple seasonality or large seasonal periods, it still requires one full iteration for <span class="math inline">\(i=1,\dots,t\)</span> to calculate <span class="math inline">\(\boldsymbol{\varepsilon}\)</span> and <span class="math inline">\(\bf{w}\)</span> and then one inversion to get the coefficients <em>for every new set of parameters</em> (i.e. for each new candidate set in the optimization).</p>
</div>
<div id="tsissm:likelihood" class="section level2">
<h2><span class="header-section-number">5.3</span> Log-Likelihood</h2>
<p>The log-likelihood (<span class="math inline">\(L\)</span>) of the model follows from the assumption that the innovations <span class="math inline">\(\varepsilon_t\sim N\left(0, \sigma^2\right)\)</span>, leading to the following form for the transformed series <span class="math inline">\(y^{\lambda}_t\)</span>:</p>
<p><span class="math display" id="eq:tsissm11">\[\begin{equation}
L\left( \theta  \right) =  - \frac{T}{2}\log \left( {2\pi {{\sigma }^2}} \right) - \frac{1}{{2{{\sigma }^2}}}\sum\limits_{t = 1}^T {\varepsilon _t^2 + \left( {\lambda  - 1} \right)\sum\limits_{t = 1}^T {\log {y_t}} }.
\tag{5.11}
\end{equation}\]</span></p>
<p>Concentrating out <span class="math inline">\(\sigma^2\)</span> with its maximum likelihood estimate, <span class="math inline">\({\hat \sigma^2} = {T^{ - 1}}\sum\limits_{t = 1}^T {\varepsilon_t^2}\)</span>, eliminating constants and taking the negative for minimization in the optimization routine leads to the following form:</p>
<p><span class="math display" id="eq:tsissm12">\[\begin{equation}
L\left( \theta  \right) = T\log \sum\limits_{t = 1}^T {\varepsilon _t^2}  - 2\left( {\lambda  - 1} \right)\sum\limits_{t = 1}^T {\log {y_t}},
\tag{5.12}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\theta\)</span> is the vector of parameters being optimized. The returned value of calling method <code>logLik</code> on an object of class <code>tsissm.estimate</code> is that of equation <a href="tsissm.html#eq:tsissm11">(5.11)</a>.</p>
</div>
<div id="tsissm:implementation" class="section level2">
<h2><span class="header-section-number">5.4</span> Package Implementation</h2>
<p>The implementation of the model in the <strong>tsissm</strong> package differs significantly from the one provided by <span class="citation">Hyndman et al. (<a href="#ref-R-forecast" role="doc-biblioref">2020</a>)</span> in the <code>tbats</code> and <code>bats</code> functions, mainly in terms of a more flexible specification object and more complete methods for working with the model, but currently lacks the automatic model selection functionality.</p>
<p>Additionally, in order to ensure that the parameters are within the forecastability region, we constrain the characteristics roots of the matrix <span class="math inline">\(\bf{D}\)</span> in <a href="tsissm.html#eq:tsissm2">(5.2)</a>, representing the non-stationary components to be inside the unit circle, and also constrain the ARMA roots for stationarity.<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></p>
</div>
<div id="tsissm:demonstration" class="section level2">
<h2><span class="header-section-number">5.5</span> Demonstration</h2>
<div id="tsissm:demonstration:specification" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Specification</h3>
<p>The specification function defines the entry point for setting up an issm model:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="tsissm.html#cb66-1"></a><span class="kw">library</span>(tsissm)</span>
<span id="cb66-2"><a href="tsissm.html#cb66-2"></a><span class="kw">args</span>(issm_modelspec)</span></code></pre></div>
<pre><code>## function (y, slope = TRUE, slope_damped = FALSE, seasonal = FALSE, 
##     seasonal_frequency = 1, seasonal_type = c(&quot;trigonometric&quot;, 
##         &quot;regular&quot;), seasonal_harmonics = NULL, ar = 0, ma = 0, 
##     xreg = NULL, lambda = 1, sampling = NULL, ...) 
## NULL</code></pre>
<p>The specification has options for slope, dampening, seasonality (trigonometric and regular),<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> AR and MA terms and external regressors. Additionally, lambda can be fixed or estimated (by setting <code>lambda = NA</code>). At present, we do not offer automatic model selection, but instead leave it to the user to decide on the appropriate model. In the future we may include a function for automatic selection similar to the <code>auto_ets</code> function in the <strong>tsets</strong> package.</p>
</div>
<div id="tsissm:demonstration:estimation" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Estimation</h3>
<p>We showcase the functionality of the package using the electricload dataset from the <strong>tsdatasets</strong> package which represents total hourly electricity load in Greece in MW as published on ENTSO-E Transparency Platform, for the period 2016-10-17 to 2019-04-30. The series appears to have multiple seasonality with periodicity 24, <span class="math inline">\(24\times 7\)</span> and <span class="math inline">\(24\times 7 \times 52\)</span>, which we model with trigonometric terms.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="tsissm.html#cb68-1"></a><span class="kw">library</span>(tsissm)</span>
<span id="cb68-2"><a href="tsissm.html#cb68-2"></a><span class="kw">data</span>(<span class="st">&quot;electricload&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;tsdatasets&quot;</span>)</span>
<span id="cb68-3"><a href="tsissm.html#cb68-3"></a><span class="co"># specification</span></span>
<span id="cb68-4"><a href="tsissm.html#cb68-4"></a>spec &lt;-<span class="st"> </span><span class="kw">issm_modelspec</span>(electricload, <span class="dt">slope =</span> <span class="ot">FALSE</span>, <span class="dt">seasonal =</span> <span class="ot">TRUE</span>, </span>
<span id="cb68-5"><a href="tsissm.html#cb68-5"></a>                       <span class="dt">seasonal_frequency =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">7</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">7</span><span class="op">*</span><span class="dv">52</span>),</span>
<span id="cb68-6"><a href="tsissm.html#cb68-6"></a>                       <span class="dt">seasonal_type =</span> <span class="st">&quot;trigonometric&quot;</span>, </span>
<span id="cb68-7"><a href="tsissm.html#cb68-7"></a>                       <span class="dt">seasonal_harmonics =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="dt">ar =</span> <span class="dv">2</span>, <span class="dt">ma =</span> <span class="dv">2</span>, </span>
<span id="cb68-8"><a href="tsissm.html#cb68-8"></a>                       <span class="dt">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb68-9"><a href="tsissm.html#cb68-9"></a><span class="co"># estimation</span></span>
<span id="cb68-10"><a href="tsissm.html#cb68-10"></a>mod &lt;-<span class="st"> </span><span class="kw">suppressMessages</span>(<span class="kw">estimate</span>(spec, <span class="dt">solver =</span> <span class="st">&quot;solnp&quot;</span>, </span>
<span id="cb68-11"><a href="tsissm.html#cb68-11"></a>                                 <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">trace =</span> <span class="dv">0</span>)))</span>
<span id="cb68-12"><a href="tsissm.html#cb68-12"></a>mod<span class="op">$</span>opt<span class="op">$</span>timing</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="tsissm.html#cb70-1"></a><span class="kw">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## -------------------------------------
## tsissm:      Summary                 
## -------------------------------------
##   parameters   optimal lower upper
##        alpha  0.106703  0.00  0.99
##    gamma24.1  0.016198 -0.01  1.00
##    gamma24.2 -0.000405 -0.01  1.00
##   gamma168.1 -0.000426 -0.01  1.00
##   gamma168.2 -0.004138 -0.01  1.00
##  gamma8736.1  0.012931 -0.01  1.00
##  gamma8736.2 -0.006961 -0.01  1.00
##       theta1  0.438848 -0.99  0.99
##       theta2  0.040952 -0.99  0.99
##         psi1  0.518389 -0.99  0.99
##         psi2  0.050841 -0.99  0.99
## 
## -------------------------------------
## tsissm: Performance Metrics
## ----------------------------------
## AIC	: 441666.48 (n = 36)
## MAPE	: 0.01827
## BIAS	: 3e-04
## MSLRE	: 0.00057</code></pre>
<p>The <code>plot</code> method decomposes the estimated model into it’s components:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="tsissm.html#cb72-1"></a><span class="kw">plot</span>(mod)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_plot-1.png" width="768" /></p>
<p>but we can also extract these directly and plot them using the <code>tsdecompose</code> method:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="tsissm.html#cb73-1"></a>td &lt;-<span class="st"> </span><span class="kw">tsdecompose</span>(mod)</span>
<span id="cb73-2"><a href="tsissm.html#cb73-2"></a><span class="kw">plot</span>(<span class="kw">as.zoo</span>(td), <span class="dt">main  =</span> <span class="st">&quot;ISSM Decomposition&quot;</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_methods1-1.png" width="768" /></p>
<p>Additional inference methods include diagnostics (<code>tsdiagnose</code>) as well as standard extractors for the coefficients (<code>coef</code>), log-likelihood (<code>logLik</code>) and AIC (<code>AIC</code>):</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="tsissm.html#cb74-1"></a><span class="kw">tsdiagnose</span>(mod, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## ARMA roots
## ------------------------------------------
## Inverse AR roots: 0.5179186 0.07907106
## Inverse MA roots: 0.3870275 0.1313619
## 
## Forecastability (D roots)
## ------------------------------------------
## Real Eigenvalues (D): 0.995 0.995 0.998 0.998 0.99 0.99 1 1 1 1 1 1 0.491 0.491 0.959 0.959 0.699 0.699 0.858 0.858 0.859 0.387 0.131 0 0
## 
## Weighted Ljung-Box Test [scaled residuals]
## ------------------------------------------
##      Lag statistic pvalue
##   Lag[1]       179      0
##  Lag[11]       897      0
##  Lag[11]       897      0
##  Lag[11]       897      0
## 
## Outlier Diagnostics (based on Rosner Test)
## ------------------------------------------
## Outliers: 2019-01-22 14:00:00 2017-05-10 19:00:00 2017-03-02 17:00:00 2019-01-22 09:00:00 2019-01-22 05:00:00 2019-01-03 07:00:00 2017-12-25 12:00:00 2019-01-22 08:00:00</code></pre>
<p><img src="tsmodels_files/figure-html/issm_methods2-1.png" width="672" /></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="tsissm.html#cb76-1"></a><span class="kw">coef</span>(mod)</span></code></pre></div>
<pre><code>##         alpha     gamma24.1     gamma24.2    gamma168.1    gamma168.2 
##  0.1067034287  0.0161975998 -0.0004051414 -0.0004258961 -0.0041378072 
##   gamma8736.1   gamma8736.2        theta1        theta2          psi1 
##  0.0129313914 -0.0069613696  0.4388475839  0.0409523768  0.5183893890 
##          psi2 
##  0.0508406536</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="tsissm.html#cb78-1"></a><span class="kw">logLik</span>(mod)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -333718.6 (df=37)</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="tsissm.html#cb80-1"></a><span class="kw">AIC</span>(mod)</span></code></pre></div>
<pre><code>## [1] 441666.5</code></pre>
</div>
<div id="tsissm:demonstration:prediction" class="section level3">
<h3><span class="header-section-number">5.5.3</span> Prediction</h3>
<p>Similar to the other packages in the <code>tsmodels</code> framework, prediction builds a distribution of possible paths by simulation, outputting an object of class <code>tsmodel.predict</code>:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="tsissm.html#cb82-1"></a>p &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, <span class="dt">h =</span> <span class="dv">24</span><span class="op">*</span><span class="dv">10</span>)</span>
<span id="cb82-2"><a href="tsissm.html#cb82-2"></a><span class="kw">plot</span>(p, <span class="dt">n_original =</span> <span class="dv">24</span><span class="op">*</span><span class="dv">20</span>, <span class="dt">main =</span> <span class="st">&quot;10-Day Hourly Forecast&quot;</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_predict-1.png" width="672" /></p>
<p>The <code>predict</code> object also has a decomposition method:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="tsissm.html#cb83-1"></a>td &lt;-<span class="st"> </span><span class="kw">tsdecompose</span>(p)</span>
<span id="cb83-2"><a href="tsissm.html#cb83-2"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>),<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb83-3"><a href="tsissm.html#cb83-3"></a><span class="kw">plot</span>(td<span class="op">$</span>Level, <span class="dt">n_original =</span> <span class="dv">24</span><span class="op">*</span><span class="dv">20</span>, <span class="dt">main =</span> <span class="st">&quot;Level[State] Predicted Distribution&quot;</span>)</span>
<span id="cb83-4"><a href="tsissm.html#cb83-4"></a><span class="kw">plot</span>(td<span class="op">$</span>Seasonal24, <span class="dt">n_original =</span> <span class="dv">24</span><span class="op">*</span><span class="dv">20</span>, </span>
<span id="cb83-5"><a href="tsissm.html#cb83-5"></a>     <span class="dt">main =</span> <span class="st">&quot;Seasonal24[State] Predicted Distribution&quot;</span>)</span>
<span id="cb83-6"><a href="tsissm.html#cb83-6"></a><span class="kw">plot</span>(td<span class="op">$</span>Seasonal168, <span class="dt">n_original =</span> <span class="dv">24</span><span class="op">*</span><span class="dv">20</span>,</span>
<span id="cb83-7"><a href="tsissm.html#cb83-7"></a>     <span class="dt">main =</span> <span class="st">&quot;Seasonal168[State] Predicted Distribution&quot;</span>)</span>
<span id="cb83-8"><a href="tsissm.html#cb83-8"></a><span class="kw">plot</span>(td<span class="op">$</span>AR2, <span class="dt">n_original =</span> <span class="dv">24</span><span class="op">*</span><span class="dv">20</span>, <span class="dt">main =</span> <span class="st">&quot;AR2[State] Predicted Distribution&quot;</span>)</span>
<span id="cb83-9"><a href="tsissm.html#cb83-9"></a><span class="kw">plot</span>(td<span class="op">$</span>MA2, <span class="dt">n_original =</span> <span class="dv">24</span><span class="op">*</span><span class="dv">20</span>, <span class="dt">main =</span> <span class="st">&quot;MA2[State] Predicted Distribution&quot;</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_predict_decompose-1.png" width="768" /></p>
</div>
<div id="tsissm:demonstration:simulation" class="section level3">
<h3><span class="header-section-number">5.5.4</span> Simulation</h3>
<p>Simulation of an estimated object has options for changing the coefficients as well as the initial states, as well as the option for providing custom innovations or bootstrapped innovations:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="tsissm.html#cb84-1"></a><span class="kw">args</span>(tsissm<span class="op">:::</span>simulate.tsissm.estimate)</span></code></pre></div>
<pre><code>## function (object, nsim = 1, seed = NULL, h = NULL, newxreg = NULL, 
##     sim_dates = NULL, bootstrap = FALSE, innov = NULL, sigma_scale = 1, 
##     pars = coef(object), init_states = object$spec$xseed, ...) 
## NULL</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="tsissm.html#cb86-1"></a>sim &lt;-<span class="st"> </span><span class="kw">simulate</span>(mod, <span class="dt">nsim =</span> <span class="dv">100</span>, <span class="dt">h =</span> <span class="dv">24</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span>, <span class="dt">bootstrap =</span> <span class="ot">TRUE</span>)</span>
<span id="cb86-2"><a href="tsissm.html#cb86-2"></a><span class="kw">plot</span>(sim)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_simulation-1.png" width="768" /></p>
<p>While the plot function on a simulated object provides a decomposition of the actual and state components distributions, it is useful to remind ourselves that the distribution bands represent the range of uncertainty of multiple paths. This is best illustrated by plotting these separately:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="tsissm.html#cb87-1"></a><span class="kw">matplot</span>(<span class="kw">as.POSIXct</span>(<span class="kw">colnames</span>(sim<span class="op">$</span>Simulated)), <span class="kw">t</span>(sim<span class="op">$</span>Simulated), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb87-2"><a href="tsissm.html#cb87-2"></a>        <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Simulated Paths&quot;</span>)</span>
<span id="cb87-3"><a href="tsissm.html#cb87-3"></a><span class="kw">grid</span>()</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="tsissm:demonstration:filtering" class="section level3">
<h3><span class="header-section-number">5.5.5</span> Filtering</h3>
<p>Online filtering is when new data arrives and instead of re-estimating the model, we instead just filter the new data based on an existing model. In the <strong>tsissm</strong> package the <code>tsfilter</code> method updates an object of class <code>tsmodel.estimate</code> with new data as the example below illustrates. Because the class of the model is retained and only updated (both data and states) with new information, it is also possible to apply any method to that which admits that object (e.g. <code>predict</code>).</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="tsissm.html#cb88-1"></a><span class="kw">library</span>(tsissm)</span>
<span id="cb88-2"><a href="tsissm.html#cb88-2"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(xts))</span>
<span id="cb88-3"><a href="tsissm.html#cb88-3"></a>weekends &lt;-<span class="st"> </span><span class="kw">xts</span>(<span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">nrow =</span> <span class="kw">nrow</span>(electricload)), <span class="kw">index</span>(electricload))</span>
<span id="cb88-4"><a href="tsissm.html#cb88-4"></a>weekends[<span class="kw">which</span>(<span class="kw">weekdays</span>(<span class="kw">as.Date</span>(<span class="kw">index</span>(weekends))) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Saturday&quot;</span>,<span class="st">&quot;Sunday&quot;</span>))] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb88-5"><a href="tsissm.html#cb88-5"></a><span class="kw">colnames</span>(weekends) &lt;-<span class="st"> &quot;weekend&quot;</span></span>
<span id="cb88-6"><a href="tsissm.html#cb88-6"></a>spec &lt;-<span class="st"> </span><span class="kw">issm_modelspec</span>(electricload[<span class="dv">1</span><span class="op">:</span><span class="dv">22000</span>], <span class="dt">slope =</span> <span class="ot">FALSE</span>, <span class="dt">xreg =</span> weekends[<span class="dv">1</span><span class="op">:</span><span class="dv">22000</span>],</span>
<span id="cb88-7"><a href="tsissm.html#cb88-7"></a>                       <span class="dt">seasonal =</span> <span class="ot">TRUE</span>, <span class="dt">seasonal_frequency =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">7</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">7</span><span class="op">*</span><span class="dv">52</span>), </span>
<span id="cb88-8"><a href="tsissm.html#cb88-8"></a>                       <span class="dt">seasonal_type =</span> <span class="st">&quot;trigonometric&quot;</span>, <span class="dt">seasonal_harmonics =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb88-9"><a href="tsissm.html#cb88-9"></a>                       <span class="dt">ar =</span> <span class="dv">2</span>, <span class="dt">ma =</span> <span class="dv">2</span>, <span class="dt">lambda =</span> <span class="ot">NA</span>)</span>
<span id="cb88-10"><a href="tsissm.html#cb88-10"></a>mod &lt;-<span class="st"> </span><span class="kw">estimate</span>(spec, <span class="dt">solver =</span> <span class="st">&quot;solnp&quot;</span>)</span>
<span id="cb88-11"><a href="tsissm.html#cb88-11"></a>f1 &lt;-<span class="st"> </span><span class="kw">tsfilter</span>(mod, <span class="dt">y =</span> electricload[<span class="dv">22001</span><span class="op">:</span><span class="dv">22100</span>], <span class="dt">newxreg =</span> weekends[<span class="dv">22001</span><span class="op">:</span><span class="dv">22100</span>])</span>
<span id="cb88-12"><a href="tsissm.html#cb88-12"></a><span class="kw">tail</span>(<span class="kw">fitted</span>(mod))</span></code></pre></div>
<pre><code>## Warning: timezone of object (UTC) is different than current timezone ().</code></pre>
<pre><code>##                         [,1]
## 2019-04-21 10:00:00 5634.844
## 2019-04-21 11:00:00 5526.292
## 2019-04-21 12:00:00 5034.468
## 2019-04-21 13:00:00 4890.952
## 2019-04-21 14:00:00 4854.412
## 2019-04-21 15:00:00 5099.741</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="tsissm.html#cb91-1"></a><span class="kw">head</span>(<span class="kw">tail</span>(<span class="kw">fitted</span>(f1), <span class="dv">100</span>),<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Warning: timezone of object (UTC) is different than current timezone ().</code></pre>
<pre><code>##                         [,1]
## 2019-04-21 16:00:00 5430.979
## 2019-04-21 17:00:00 5754.287
## 2019-04-21 18:00:00 6146.832
## 2019-04-21 19:00:00 5907.693
## 2019-04-21 20:00:00 5332.229
## 2019-04-21 21:00:00 4920.201
## 2019-04-21 22:00:00 4492.700
## 2019-04-21 23:00:00 4218.722
## 2019-04-22 00:00:00 4241.625
## 2019-04-22 01:00:00 4150.824</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="tsissm.html#cb94-1"></a><span class="kw">plot</span>(f1)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_filtering-1.png" width="768" /></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="tsissm.html#cb95-1"></a>f2 &lt;-<span class="st"> </span><span class="kw">tsfilter</span>(f1, <span class="dt">y =</span> electricload[<span class="dv">22100</span><span class="op">:</span><span class="dv">22200</span>], <span class="dt">newxreg =</span> weekends[<span class="dv">22100</span><span class="op">:</span><span class="dv">22200</span>])</span>
<span id="cb95-2"><a href="tsissm.html#cb95-2"></a><span class="kw">tail</span>(<span class="kw">fitted</span>(f1))</span></code></pre></div>
<pre><code>## Warning: timezone of object (UTC) is different than current timezone ().</code></pre>
<pre><code>##                         [,1]
## 2019-04-25 14:00:00 5752.368
## 2019-04-25 15:00:00 5831.491
## 2019-04-25 16:00:00 6012.804
## 2019-04-25 17:00:00 6051.963
## 2019-04-25 18:00:00 6102.939
## 2019-04-25 19:00:00 5724.208</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="tsissm.html#cb98-1"></a><span class="kw">head</span>(<span class="kw">tail</span>(<span class="kw">fitted</span>(f2), <span class="dv">100</span>),<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Warning: timezone of object (UTC) is different than current timezone ().</code></pre>
<pre><code>##                         [,1]
## 2019-04-25 20:00:00 5179.796
## 2019-04-25 21:00:00 4822.841
## 2019-04-25 22:00:00 4395.456
## 2019-04-25 23:00:00 4184.391
## 2019-04-26 00:00:00 4149.133
## 2019-04-26 01:00:00 4094.189
## 2019-04-26 02:00:00 4022.150
## 2019-04-26 03:00:00 4235.648
## 2019-04-26 04:00:00 4361.716
## 2019-04-26 05:00:00 4646.646</code></pre>
</div>
<div id="tsissm:demonstration:profiling" class="section level3">
<h3><span class="header-section-number">5.5.6</span> Profiling</h3>
<p>The <code>tsprofile</code> function profiles an estimated model by simulating and then estimating multiple paths from the assumed DGP while leaving <code>h</code> values out for prediction evaluation. Each simulated path is equal to the size of the original dataset plus <code>h</code> additional values, and initialized with the initial state vector from the model. The resulting output contains the distribution of the MAPE, percent bias (BIAS) and mean squared log relative error (MSLRE) per horizon <code>h</code>. Since these matrices are of class <code>tsmodel.distribution</code> they can be readily plotted with the special purpose <code>plot</code> function for this class from the <strong>tsmethods</strong> package. Additionally, a data.table matrix is also return with the distribution of the coefficients from each path estimation.
As of version , the <code>tsprofile</code> method on a <code>tsissm.estimate</code> object does not support <code>newxreg</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="tsissm.html#cb101-1"></a>spec &lt;-<span class="st"> </span><span class="kw">issm_modelspec</span>(electricload[<span class="dv">1</span><span class="op">:</span><span class="dv">22000</span>], <span class="dt">slope =</span> <span class="ot">FALSE</span>, <span class="dt">seasonal =</span> <span class="ot">TRUE</span>, </span>
<span id="cb101-2"><a href="tsissm.html#cb101-2"></a>                       <span class="dt">seasonal_frequency =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">7</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">7</span><span class="op">*</span><span class="dv">52</span>),</span>
<span id="cb101-3"><a href="tsissm.html#cb101-3"></a>                       <span class="dt">seasonal_type =</span> <span class="st">&quot;trigonometric&quot;</span>, <span class="dt">seasonal_harmonics =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb101-4"><a href="tsissm.html#cb101-4"></a>                       <span class="dt">ar =</span> <span class="dv">2</span>, <span class="dt">ma =</span> <span class="dv">2</span>, <span class="dt">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb101-5"><a href="tsissm.html#cb101-5"></a>mod &lt;-<span class="st"> </span><span class="kw">estimate</span>(spec, <span class="dt">solver =</span> <span class="st">&quot;solnp&quot;</span>)</span>
<span id="cb101-6"><a href="tsissm.html#cb101-6"></a>prof &lt;-<span class="st"> </span><span class="kw">tsprofile</span>(mod, <span class="dt">h =</span> <span class="dv">24</span><span class="op">*</span><span class="dv">7</span>, <span class="dt">nsim =</span> <span class="dv">100</span>, <span class="dt">cores =</span> <span class="dv">4</span>, <span class="dt">solver =</span> <span class="st">&quot;solnp&quot;</span>)</span>
<span id="cb101-7"><a href="tsissm.html#cb101-7"></a><span class="kw">plot</span>(prof)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_profile-1.png" width="768" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="tsissm.html#cb102-1"></a><span class="kw">plot</span>(prof, <span class="dt">type =</span> <span class="st">&quot;coef&quot;</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_profile-2.png" width="768" /></p>
</div>
<div id="tsissm:demonstration:backtesting" class="section level3">
<h3><span class="header-section-number">5.5.7</span> Backtesting</h3>
<p>The <code>tsbacktest</code> method generates an expanding window walk forward backtest, returning a list with the estimation/horizon predictions against actuals as well as a table of average performance metrics by horizon.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="tsissm.html#cb103-1"></a>spec &lt;-<span class="st"> </span><span class="kw">issm_modelspec</span>(electricload, <span class="dt">slope =</span> <span class="ot">FALSE</span>, <span class="dt">seasonal =</span> <span class="ot">TRUE</span>, </span>
<span id="cb103-2"><a href="tsissm.html#cb103-2"></a>                       <span class="dt">seasonal_frequency =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">7</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">7</span><span class="op">*</span><span class="dv">52</span>), </span>
<span id="cb103-3"><a href="tsissm.html#cb103-3"></a>                       <span class="dt">seasonal_type =</span> <span class="st">&quot;trigonometric&quot;</span>, <span class="dt">seasonal_harmonics =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb103-4"><a href="tsissm.html#cb103-4"></a>                       <span class="dt">ar =</span> <span class="dv">2</span>, <span class="dt">ma =</span> <span class="dv">2</span>, <span class="dt">lambda =</span> <span class="ot">NA</span>)</span>
<span id="cb103-5"><a href="tsissm.html#cb103-5"></a>b &lt;-<span class="st"> </span><span class="kw">tsbacktest</span>(spec, <span class="dt">start =</span> <span class="dv">22150</span>, <span class="dt">h =</span> <span class="dv">24</span>, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="fl">0.02</span>, <span class="fl">0.1</span>), <span class="dt">cores =</span> <span class="dv">5</span>, </span>
<span id="cb103-6"><a href="tsissm.html#cb103-6"></a>                <span class="dt">data_name =</span> <span class="st">&quot;electricity&quot;</span>, <span class="dt">solver =</span> <span class="st">&quot;solnp&quot;</span>, <span class="dt">trace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb103-7"><a href="tsissm.html#cb103-7"></a><span class="kw">head</span>(b<span class="op">$</span>metrics)</span></code></pre></div>
<pre><code>##    horizon    variable       MAPE       MSLRE       BIAS  n MIS[0.02]  MIS[0.1]
## 1:       1 electricity 0.03453686 0.002008403 0.01064633 73  1509.709  818.5592
## 2:       2 electricity 0.04542751 0.003453705 0.01379530 72  2797.289 1293.8717
## 3:       3 electricity 0.05722549 0.005171447 0.01764414 71  3740.733 1736.8172
## 4:       4 electricity 0.06419392 0.006124358 0.01896112 70  4443.514 1930.2262
## 5:       5 electricity 0.06987296 0.007363092 0.02024584 69  5247.636 2305.3943
## 6:       6 electricity 0.07558653 0.008350822 0.02229894 68  5962.675 2528.8641</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="tsissm.html#cb105-1"></a><span class="kw">plot</span>(b<span class="op">$</span>metrics<span class="op">$</span>horizon, b<span class="op">$</span>metrics<span class="op">$</span>MAPE<span class="op">*</span><span class="dv">100</span>, <span class="dt">main =</span> <span class="st">&quot;Horizon MAPE&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb105-2"><a href="tsissm.html#cb105-2"></a>     <span class="dt">ylab =</span> <span class="st">&quot;MAPE[%]&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;horizon&quot;</span>)</span>
<span id="cb105-3"><a href="tsissm.html#cb105-3"></a><span class="kw">grid</span>()</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_backtest-1.png" width="768" /></p>
<p>The variable <code>n</code> in the table reports the number of h-step ahead predictions made on which the average metrics were calculated.</p>
</div>
<div id="tsissm:demonstration:benchmarking" class="section level3">
<h3><span class="header-section-number">5.5.8</span> Benchmarking</h3>
<p>The <code>tsbenchmark*</code> method is used to benchmark a model for timing and accuracy and can be used as a unit testing function.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="tsissm.html#cb106-1"></a>spec &lt;-<span class="st"> </span><span class="kw">issm_modelspec</span>(electricload, <span class="dt">slope =</span> <span class="ot">FALSE</span>, <span class="dt">seasonal =</span> <span class="ot">TRUE</span>, </span>
<span id="cb106-2"><a href="tsissm.html#cb106-2"></a>                       <span class="dt">seasonal_frequency =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">7</span>, <span class="dv">24</span><span class="op">*</span><span class="dv">7</span><span class="op">*</span><span class="dv">52</span>),</span>
<span id="cb106-3"><a href="tsissm.html#cb106-3"></a>                       <span class="dt">seasonal_type =</span> <span class="st">&quot;trigonometric&quot;</span>, <span class="dt">seasonal_harmonics =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb106-4"><a href="tsissm.html#cb106-4"></a>                       <span class="dt">ar =</span> <span class="dv">2</span>, <span class="dt">ma =</span> <span class="dv">2</span>, <span class="dt">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb106-5"><a href="tsissm.html#cb106-5"></a>bench &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">tsbenchmark</span>(spec, <span class="dt">solver =</span> <span class="st">&quot;optim&quot;</span>),</span>
<span id="cb106-6"><a href="tsissm.html#cb106-6"></a>               <span class="kw">tsbenchmark</span>(spec, <span class="dt">solver =</span> <span class="st">&quot;nlminb&quot;</span>),</span>
<span id="cb106-7"><a href="tsissm.html#cb106-7"></a>               <span class="kw">tsbenchmark</span>(spec, <span class="dt">solver =</span> <span class="st">&quot;solnp&quot;</span>))</span>
<span id="cb106-8"><a href="tsissm.html#cb106-8"></a><span class="kw">print</span>(bench)</span></code></pre></div>
<pre><code>##                  start                 end              spec
## 1: 2020-09-10 13:31:13 2020-09-10 13:35:33 &lt;tsissm.spec[10]&gt;
## 2: 2020-09-10 13:35:33 2020-09-10 13:35:58 &lt;tsissm.spec[10]&gt;
## 3: 2020-09-10 13:35:58 2020-09-10 13:36:24 &lt;tsissm.spec[10]&gt;
##                estimate solver control    loglik
## 1: &lt;tsissm.estimate[4]&gt;  optim       0       NaN
## 2: &lt;tsissm.estimate[4]&gt; nlminb       0 -342668.9
## 3: &lt;tsissm.estimate[4]&gt;  solnp       0 -333718.6</code></pre>
<p>In the current example, the <code>optim</code> solver did not converge, whilst the <code>solnp</code> solver achieved the highest log likelihood in about 14 seconds. Because of the constraint requirements for both the <span class="math inline">\(\bf{D}\)</span> matrix as well as the ARMA roots, the problem, while convex, is non-smooth as currently constructed and hence care should be taken in checking the solution.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-anderson2012optimal">
<p>Anderson, Brian DO, and John B Moore. 2012. <em>Optimal Filtering</em>. Courier Corporation.</p>
</div>
<div id="ref-de1991diffuse">
<p>De Jong, Piet, and others. 1991. “The Diffuse Kalman Filter.” <em>The Annals of Statistics</em> 19 (2): 1073–83.</p>
</div>
<div id="ref-de2011forecasting">
<p>De Livera, Alysha M, Rob J Hyndman, and Ralph D Snyder. 2011. “Forecasting Time Series with Complex Seasonal Patterns Using Exponential Smoothing.” <em>Journal of the American Statistical Association</em> 106 (496): 1513–27.</p>
</div>
<div id="ref-R-forecast">
<p>Hyndman, Rob, George Athanasopoulos, Christoph Bergmeir, Gabriel Caceres, Leanne Chhay, Mitchell O’Hara-Wild, Fotios Petropoulos, Slava Razbash, Earo Wang, and Farah Yasmeen. 2020. <em>Forecast: Forecasting Functions for Time Series and Linear Models</em>. <a href="https://CRAN.R-project.org/package=forecast">https://CRAN.R-project.org/package=forecast</a>.</p>
</div>
<div id="ref-hyndman2008">
<p>Hyndman, Rob, Anne B Koehler, J Keith Ord, and Ralph D Snyder. 2008. <em>Forecasting with Exponential Smoothing: The State Space Approach</em>. Springer Science &amp; Business Media.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>The following equations apply for the case when all components are present (level, slope, seasonal and ARMA).<a href="tsissm.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>For <span class="math inline">\(j=1,\dots,k_i\)</span> and <span class="math inline">\(i=1,\dots,T\)</span>, representing the number of harmonics <span class="math inline">\(k\)</span> per seasonal period <span class="math inline">\(i\)</span>.<a href="tsissm.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>For simplicity of exposition, <span class="math inline">\(y_t\)</span> is equivalent to <span class="math inline">\(y_t^{(\lambda)}\)</span>.<a href="tsissm.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>So that the inverse of the characteristic roots are inside the unit circle.<a href="tsissm.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>Currently, multiple seasonality is not implemented for the regular case, but will be added in due course.<a href="tsissm.html#fnref14" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tsets.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tsvets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
