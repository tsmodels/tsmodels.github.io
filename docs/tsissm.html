<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 tsissm package | A Time Series Framework</title>
  <meta name="description" content="Documentation for the tsmodels framework" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 tsissm package | A Time Series Framework" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Documentation for the tsmodels framework" />
  <meta name="github-repo" content="tsmodels/tsmodels.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 tsissm package | A Time Series Framework" />
  
  <meta name="twitter:description" content="Documentation for the tsmodels framework" />
  

<meta name="author" content="The tsmodels team" />


<meta name="date" content="2022-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tsets.html"/>
<link rel="next" href="tsvets.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-177357579-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  
  function gtag(){dataLayer.push(arguments);}
  
  gtag('js', new Date());
  
  gtag('config', 'UA-177357579-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series Forecasting Framework</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Installation</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="tsmethods.html"><a href="tsmethods.html"><i class="fa fa-check"></i><b>3</b> tsmethods package</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tsmethods.html"><a href="tsmethods.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="tsmethods.html"><a href="tsmethods.html#tsmethods:simulation"><i class="fa fa-check"></i><b>3.2</b> Ensembling Forecast Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="tsmethods.html"><a href="tsmethods.html#demonstration"><i class="fa fa-check"></i><b>3.3</b> Demonstration</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tsets.html"><a href="tsets.html"><i class="fa fa-check"></i><b>4</b> tsets package</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tsets.html"><a href="tsets.html#tsets:intro"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="tsets.html"><a href="tsets.html#tsets:taxonomy"><i class="fa fa-check"></i><b>4.2</b> Taxonomy of Models</a></li>
<li class="chapter" data-level="4.3" data-path="tsets.html"><a href="tsets.html#tsets:extensions"><i class="fa fa-check"></i><b>4.3</b> Extensions</a></li>
<li class="chapter" data-level="4.4" data-path="tsets.html"><a href="tsets.html#some-encompasing-alternatives"><i class="fa fa-check"></i><b>4.4</b> Some Encompasing Alternatives</a></li>
<li class="chapter" data-level="4.5" data-path="tsets.html"><a href="tsets.html#tsets:implementation"><i class="fa fa-check"></i><b>4.5</b> Package Implementation</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="tsets.html"><a href="tsets.html#tsets:implementation:constraints"><i class="fa fa-check"></i><b>4.5.1</b> Constraints</a></li>
<li class="chapter" data-level="4.5.2" data-path="tsets.html"><a href="tsets.html#tsets:implementation:initialization"><i class="fa fa-check"></i><b>4.5.2</b> Initialization</a></li>
<li class="chapter" data-level="4.5.3" data-path="tsets.html"><a href="tsets.html#tsets:implementation:transformations"><i class="fa fa-check"></i><b>4.5.3</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tsets.html"><a href="tsets.html#tsets:demonstration"><i class="fa fa-check"></i><b>4.6</b> Demonstration</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:specification"><i class="fa fa-check"></i><b>4.6.1</b> The Specification Object</a></li>
<li class="chapter" data-level="4.6.2" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:estimation"><i class="fa fa-check"></i><b>4.6.2</b> Estimation</a></li>
<li class="chapter" data-level="4.6.3" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:prediction"><i class="fa fa-check"></i><b>4.6.3</b> Prediction</a></li>
<li class="chapter" data-level="4.6.4" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:filtering"><i class="fa fa-check"></i><b>4.6.4</b> Filtering</a></li>
<li class="chapter" data-level="4.6.5" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:simulation"><i class="fa fa-check"></i><b>4.6.5</b> Simulation</a></li>
<li class="chapter" data-level="4.6.6" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:profiling"><i class="fa fa-check"></i><b>4.6.6</b> Profiling</a></li>
<li class="chapter" data-level="4.6.7" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:backtesting"><i class="fa fa-check"></i><b>4.6.7</b> Backtesting</a></li>
<li class="chapter" data-level="4.6.8" data-path="tsets.html"><a href="tsets.html#tsets:demonstration:benchmarking"><i class="fa fa-check"></i><b>4.6.8</b> Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tsissm.html"><a href="tsissm.html"><i class="fa fa-check"></i><b>5</b> tsissm package</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tsissm.html"><a href="tsissm.html#tsissm:introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="tsissm.html"><a href="tsissm.html#tsissm:initialization"><i class="fa fa-check"></i><b>5.2</b> State Initialization</a></li>
<li class="chapter" data-level="5.3" data-path="tsissm.html"><a href="tsissm.html#tsissm:likelihood"><i class="fa fa-check"></i><b>5.3</b> Log-Likelihood</a></li>
<li class="chapter" data-level="5.4" data-path="tsissm.html"><a href="tsissm.html#tsissm:implementation"><i class="fa fa-check"></i><b>5.4</b> Package Implementation</a></li>
<li class="chapter" data-level="5.5" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration"><i class="fa fa-check"></i><b>5.5</b> Demonstration</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:specification"><i class="fa fa-check"></i><b>5.5.1</b> Specification</a></li>
<li class="chapter" data-level="5.5.2" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:estimation"><i class="fa fa-check"></i><b>5.5.2</b> Estimation</a></li>
<li class="chapter" data-level="5.5.3" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:prediction"><i class="fa fa-check"></i><b>5.5.3</b> Prediction</a></li>
<li class="chapter" data-level="5.5.4" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:simulation"><i class="fa fa-check"></i><b>5.5.4</b> Simulation</a></li>
<li class="chapter" data-level="5.5.5" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:filtering"><i class="fa fa-check"></i><b>5.5.5</b> Filtering</a></li>
<li class="chapter" data-level="5.5.6" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:profiling"><i class="fa fa-check"></i><b>5.5.6</b> Profiling</a></li>
<li class="chapter" data-level="5.5.7" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:backtesting"><i class="fa fa-check"></i><b>5.5.7</b> Backtesting</a></li>
<li class="chapter" data-level="5.5.8" data-path="tsissm.html"><a href="tsissm.html#tsissm:demonstration:benchmarking"><i class="fa fa-check"></i><b>5.5.8</b> Benchmarking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tsvets.html"><a href="tsvets.html"><i class="fa fa-check"></i><b>6</b> tsvets package</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:regressors"><i class="fa fa-check"></i><b>6.2</b> Inclusion of External Regressors</a></li>
<li class="chapter" data-level="6.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:likelihood"><i class="fa fa-check"></i><b>6.3</b> Log-Likelihood</a></li>
<li class="chapter" data-level="6.4" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence"><i class="fa fa-check"></i><b>6.4</b> Dependence Structure</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:diagonal"><i class="fa fa-check"></i><b>6.4.1</b> Diagonal Covariance</a></li>
<li class="chapter" data-level="6.4.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:equicorrelation"><i class="fa fa-check"></i><b>6.4.2</b> Equicorrelation</a></li>
<li class="chapter" data-level="6.4.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:dependence:shrinkage"><i class="fa fa-check"></i><b>6.4.3</b> Shrinkage Covariance</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="tsvets.html"><a href="tsvets.html#tsvets:grouping"><i class="fa fa-check"></i><b>6.5</b> Grouping and Pooling</a></li>
<li class="chapter" data-level="6.6" data-path="tsvets.html"><a href="tsvets.html#tsvets:homogeneous"><i class="fa fa-check"></i><b>6.6</b> Homogeneous Coefficients and Aggregation</a></li>
<li class="chapter" data-level="6.7" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration"><i class="fa fa-check"></i><b>6.7</b> Demonstration</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:specification"><i class="fa fa-check"></i><b>6.7.1</b> Specification</a></li>
<li class="chapter" data-level="6.7.2" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example1"><i class="fa fa-check"></i><b>6.7.2</b> Example: Australian Retail Sales</a></li>
<li class="chapter" data-level="6.7.3" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example2"><i class="fa fa-check"></i><b>6.7.3</b> Example: Australian Retail Sales Grouped Dynamics</a></li>
<li class="chapter" data-level="6.7.4" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example3"><i class="fa fa-check"></i><b>6.7.4</b> Example: Australian Retail Sales Filtering</a></li>
<li class="chapter" data-level="6.7.5" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example4"><i class="fa fa-check"></i><b>6.7.5</b> Example: Australian Retail Sales Aggregation</a></li>
<li class="chapter" data-level="6.7.6" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example6"><i class="fa fa-check"></i><b>6.7.6</b> Example: Groupwise Pooling</a></li>
<li class="chapter" data-level="6.7.7" data-path="tsvets.html"><a href="tsvets.html#tsvets:demonstration:example5"><i class="fa fa-check"></i><b>6.7.7</b> Example: Price Volume Aggregation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tsforeign.html"><a href="tsforeign.html"><i class="fa fa-check"></i><b>7</b> tsforeign package</a>
<ul>
<li class="chapter" data-level="7.1" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:arima"><i class="fa fa-check"></i><b>7.2</b> ARIMA model</a></li>
<li class="chapter" data-level="7.3" data-path="tsforeign.html"><a href="tsforeign.html#tsforeign:bsts"><i class="fa fa-check"></i><b>7.3</b> bsts model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tscausal.html"><a href="tscausal.html"><i class="fa fa-check"></i><b>8</b> tscausal package</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tscausal.html"><a href="tscausal.html#tscausal:introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="tscausal.html"><a href="tscausal.html#tscausal:evalmeasures"><i class="fa fa-check"></i><b>8.2</b> Measures of Evaluation</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="tscausal.html"><a href="tscausal.html#tscausal:evalmeasures:pointwise"><i class="fa fa-check"></i><b>8.2.1</b> Pointwise Impact</a></li>
<li class="chapter" data-level="8.2.2" data-path="tscausal.html"><a href="tscausal.html#tscausal:evalmeasures:cumulative"><i class="fa fa-check"></i><b>8.2.2</b> Cumulative Impact</a></li>
<li class="chapter" data-level="8.2.3" data-path="tscausal.html"><a href="tscausal.html#tscausal:evalmeasures:meaneffect"><i class="fa fa-check"></i><b>8.2.3</b> Mean Effect</a></li>
<li class="chapter" data-level="8.2.4" data-path="tscausal.html"><a href="tscausal.html#tscausal:evalmeasures:relativeeffect"><i class="fa fa-check"></i><b>8.2.4</b> Mean Relative Effect</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tscausal.html"><a href="tscausal.html#tscausal:significance"><i class="fa fa-check"></i><b>8.3</b> Evaluation of Significance</a></li>
<li class="chapter" data-level="8.4" data-path="tscausal.html"><a href="tscausal.html#tscausl:features"><i class="fa fa-check"></i><b>8.4</b> Package Features</a></li>
<li class="chapter" data-level="8.5" data-path="tscausal.html"><a href="tscausal.html#tscausl:demo"><i class="fa fa-check"></i><b>8.5</b> Package Demo</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tsdistributions.html"><a href="tsdistributions.html"><i class="fa fa-check"></i><b>9</b> tsdistributions package</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:introduction"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions"><i class="fa fa-check"></i><b>9.2</b> Distributions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:norm"><i class="fa fa-check"></i><b>9.2.1</b> The Normal Distribution</a></li>
<li class="chapter" data-level="9.2.2" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:std"><i class="fa fa-check"></i><b>9.2.2</b> The Student Distribution</a></li>
<li class="chapter" data-level="9.2.3" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:ged"><i class="fa fa-check"></i><b>9.2.3</b> The Generalized Error Distribution</a></li>
<li class="chapter" data-level="9.2.4" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:skewed"><i class="fa fa-check"></i><b>9.2.4</b> Skewed Distributions by Inverse Scale Factors</a></li>
<li class="chapter" data-level="9.2.5" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:ghyp"><i class="fa fa-check"></i><b>9.2.5</b> The Generalized Hyperbolic Distribution and Sub-Families</a></li>
<li class="chapter" data-level="9.2.6" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:ghst"><i class="fa fa-check"></i><b>9.2.6</b> The Generalized Hyperbolic Skew Student Distribution</a></li>
<li class="chapter" data-level="9.2.7" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:distributions:jsu"><i class="fa fa-check"></i><b>9.2.7</b> Johnson’s reparameterized SU Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:moments"><i class="fa fa-check"></i><b>9.3</b> A note on analytic higher moments</a></li>
<li class="chapter" data-level="9.4" data-path="tsdistributions.html"><a href="tsdistributions.html#tsdistributions:code"><i class="fa fa-check"></i><b>9.4</b> Implementation and Code Examples</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tsgam.html"><a href="tsgam.html"><i class="fa fa-check"></i><b>10</b> tsgam package</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tsgam.html"><a href="tsgam.html#tsgam:introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="tsgam.html"><a href="tsgam.html#package-demo-electricity-load"><i class="fa fa-check"></i><b>10.2</b> Package Demo: Electricity Load</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="tsgam.html"><a href="tsgam.html#estimation"><i class="fa fa-check"></i><b>10.2.1</b> Estimation</a></li>
<li class="chapter" data-level="10.2.2" data-path="tsgam.html"><a href="tsgam.html#prediction"><i class="fa fa-check"></i><b>10.2.2</b> Prediction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="other.html"><a href="other.html"><i class="fa fa-check"></i><b>11</b> Other packages</a></li>
<li class="chapter" data-level="12" data-path="experimental.html"><a href="experimental.html"><i class="fa fa-check"></i><b>12</b> Experimental Functionality</a>
<ul>
<li class="chapter" data-level="12.1" data-path="experimental.html"><a href="experimental.html#calibration-of-predictive-distributions"><i class="fa fa-check"></i><b>12.1</b> Calibration of Predictive Distributions</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="experimental.html"><a href="experimental.html#example-coming-soon"><i class="fa fa-check"></i><b>12.1.1</b> Example [Coming Soon]</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="experimental.html"><a href="experimental.html#beyond-box-cox-the-logit-normal-assumption-for-ratios"><i class="fa fa-check"></i><b>12.2</b> Beyond Box-Cox : The Logit-Normal Assumption for Ratios</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="news.html"><a href="news.html"><i class="fa fa-check"></i><b>13</b> News</a></li>
<li class="chapter" data-level="14" data-path="team.html"><a href="team.html"><i class="fa fa-check"></i><b>14</b> The tsmodels team</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Time Series Framework</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tsissm" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> tsissm package<a href="tsissm.html#tsissm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="tsissm:introduction" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction<a href="tsissm.html#tsissm:introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <strong>tsissm</strong> package implements the linear (and homoscedastic) innovations state space
model described in <span class="citation">De Livera, Hyndman, and Snyder (<a href="#ref-de2011forecasting" role="doc-biblioref">2011</a>)</span> and originally proposed by <span class="citation">Anderson and Moore (<a href="#ref-anderson2012optimal" role="doc-biblioref">2012</a>)</span>.
It is in some ways similar to the ETS based models described in <span class="citation">R. Hyndman et al. (<a href="#ref-hyndman2008" role="doc-biblioref">2008</a>)</span>,
but with the flexibility of incorporating multiple seasonality, ARMA terms and
joint maximization of the Box Cox variance stabilizing lambda parameter.</p>
<p>The following is taken from <span class="citation">De Livera, Hyndman, and Snyder (<a href="#ref-de2011forecasting" role="doc-biblioref">2011</a>)</span>. Consider the following SEM model:</p>
<p><span class="math display" id="eq:tsissm1">\[\begin{equation}
\begin{array}{l}
y_t^\lambda  = {\bf{w&#39;}}{{\bf{x}}_{t - 1}} + \bf{c&#39;}\bf{u}_{t - 1}  + {\varepsilon _t}, \quad \varepsilon_t\sim N\left(0,\sigma^2\right),\\
{{\bf{x}}_t} = {\bf{F}}{{\bf{x}}_{t - 1}} + {\bf{g}}{\varepsilon _t},
\end{array}
\tag{5.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> represents the Box Cox parameter, <span class="math inline">\(\bf{w}\)</span> the observation coefficient vector, <span class="math inline">\(\bf{x}_t\)</span> the unobserved state vector, <span class="math inline">\(\bf{c}\)</span> a vector of coefficients on the external regressor set <span class="math inline">\(\bf{u}\)</span>.</p>
<p>Define the state vector<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> as:</p>
<p><span class="math display" id="eq:tsissm2">\[\begin{equation}
\bf{x}_t = {\left( {{l_t},{b_t},s_t^{(1)},\dots,s_t^{(T)},{d_t},{d_{t - 1}},\dots,{d_{t - p - 1}},{\varepsilon_t},{\varepsilon_{t - 1}},\dots,{\varepsilon _{t - q - 1}}} \right)^\prime },
\tag{5.2}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\bf{s}_t^{(i)}\)</span> is the row vector <span class="math inline">\(\left( {s_{1,t}^{(i)},s_{2,t}^{(i)},\dots,s_{{k_i},t}^{(i)},s_{1,t}^{*(i)},s_{2,t}^{*(i)},\dots,s_{{k_i},t}^{*(i)}} \right)\)</span> in the case of trigonometric seasonality, and <span class="math inline">\(\left( {s_t^{(i)},s_{t - 1}^{(i)},\dots,s_{t - ({m_i} - 1)}^{(i)}} \right)\)</span> in the case of regular seasonality. Also define <span class="math inline">\(\bf{1}_r\)</span> and <span class="math inline">\(\bf{0}_r\)</span> as a vector of ones and zeros, respectively, of length <span class="math inline">\(r\)</span>, <span class="math inline">\(\bf{O}_{u,v}\)</span> a <span class="math inline">\(u\times v\)</span> matrix of zeros and <span class="math inline">\(\bf{I}_{u,v}\)</span> a <span class="math inline">\(u\times v\)</span> diagonal matrix of ones; let <span class="math inline">\(\mathbf{\gamma} = \left(\mathbf{\gamma}^{(1)},\dots,\mathbf{\gamma}^{(T)} \right)\)</span> be a vector of seasonal parameters with <span class="math inline">\({\gamma ^{(i)}} = \left( {\gamma _1^{(i)}{{\bf{1}}_{{k_i}}},\gamma _2^{(i)}{{\bf{1}}_{{k_i}}}} \right)\)</span> in the trigonometric seasonality case (with <span class="math inline">\(k\)</span> harmonics), and <span class="math inline">\({\gamma ^{(i)}} = \left( {{\gamma _i},{{\bf{0}}_{{m_i} - 1}}} \right)\)</span> in the regular seasonality case; define <span class="math inline">\(\theta = \left( {{\theta_1},{\theta_2},\dots,{\theta _p}} \right)\)</span> and <span class="math inline">\(\psi = \left( {{\psi _1},{\psi _2},\dots,{\psi_q}} \right)\)</span> as the vector of AR(p) and MA(q) parameters, respectively.
Define the observation transition vector <span class="math inline">\({\bf{w}} = {\left( {1,\phi ,{\bf{a}},\theta ,\psi } \right)^\prime }\)</span>, where <span class="math inline">\({\bf{a}} = \left( {{{\bf{a}}^{(1)}},\dots,{{\bf{a}}^{(T)}}} \right)\)</span> with <span class="math inline">\({{\bf{a}}^{(i)}} = \left( {{{\bf{1}}_{{k_i}}},{{\bf{0}}_{{k_i}}}} \right)\)</span> for the trigonometric case and <span class="math inline">\({{\bf{a}}^{(i)}} = \left( {{{\bf{0}}_{{m_i} - 1}},1} \right)\)</span> for the regular seasonality case. Define the state error adjustment vector <span class="math inline">\({\bf{g}} = {\left( {\alpha ,\beta ,\gamma ,1,{{\bf{0}}_{p - 1}},1,{{\bf{0}}_{q - 1}}} \right)^\prime }\)</span>. Further, let <span class="math inline">\({\bf{B}} = \gamma &#39;\theta\)</span>, <span class="math inline">\({\bf{C}} = \gamma &#39;\psi\)</span> and <span class="math inline">\({\bf{A}} = \oplus _{i = 1}^T{{\bf{A}}_i}\)</span>, with</p>
<p><span class="math display" id="eq:tsissm3">\[\begin{equation}
{{\bf{A}}_i} = \left[ {\begin{array}{*{20}{c}}
{{{\bf{C}}^{(i)}}}&amp;{{{\bf{S}}^{(i)}}}\\
{ - {{\bf{S}}^{(i)}}}&amp;{{{\bf{C}}^{(i)}}}
\end{array}} \right],
\tag{5.3}
\end{equation}\]</span></p>
<p>for the trigonometric case and with <span class="math inline">\(\bf{C}^{(i)}\)</span> and <span class="math inline">\(\bf{S}^{(i)}\)</span> representing the <span class="math inline">\(k_i\times k_i\)</span> diagonal matrices with elements <span class="math inline">\(cos(\lambda_j^{(i)})\)</span> and <span class="math inline">\(sin(\lambda_j^{(i)})\)</span> respectively,<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> and</p>
<p><span class="math display" id="eq:tsissm4">\[\begin{equation}
{{\bf{A}}_i} = \left[ {\begin{array}{*{20}{c}}
{{{\bf{0}}_{{m_i} - 1}}}&amp;1\\
{{{\bf{I}}_{{m_i} - 1}}}&amp;{{{{\bf{0&#39;}}}_{{m_i} - 1}}}
\end{array}} \right],
\tag{5.4}
\end{equation}\]</span></p>
<p>for the regular seasonality case, with <span class="math inline">\(\oplus\)</span> being the direct sum of matrices operator. Finally, the state transition matrix <span class="math inline">\(\bf{F}\)</span> is composed as follows:</p>
<p><span class="math display" id="eq:tsissm5">\[\begin{equation}
{\bf{F}} = \left[ {\begin{array}{*{20}{c}}
1&amp;\phi &amp;{{{\bf{0}}_\tau }}&amp;{\alpha \theta }&amp;{\alpha \psi }\\
0&amp;\phi &amp;{{{\bf{0}}_\tau }}&amp;{\beta \theta }&amp;{\beta \psi }\\
{{{{\bf{0&#39;}}}_\tau }}&amp;{{{{\bf{0&#39;}}}_\tau }}&amp;{\bf{A}}&amp;{\bf{B}}&amp;{\bf{C}}\\
0&amp;0&amp;{{{\bf{0}}_\tau }}&amp;\theta &amp;\psi \\
{{{{\bf{0&#39;}}}_{p - 1}}}&amp;{{{{\bf{0&#39;}}}_{p - 1}}}&amp;{{{\bf{O}}_{p - 1,\tau }}}&amp;{{{\bf{I}}_{p - 1,p}}}&amp;{{{\bf{O}}_{p - 1,q}}}\\
0&amp;0&amp;{{{\bf{0}}_\tau }}&amp;{{{\bf{0}}_p}}&amp;{{{\bf{0}}_q}}\\
{{{{\bf{0&#39;}}}_{q - 1}}}&amp;{{{{\bf{0&#39;}}}_{q - 1}}}&amp;{{{\bf{O}}_{q - 1,\tau }}}&amp;{{{\bf{O}}_{q - 1,p}}}&amp;{{{\bf{I}}_{q - 1,q}}}
\end{array}} \right]
\tag{5.5}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\tau = 2\sum\limits_{i = 1}^T {{k_i}}\)</span> for the trigonometric case and <span class="math inline">\(\tau = \sum\limits_{i = 1}^T {{m_i}}\)</span> for the regular seasonality case.</p>
</div>
<div id="tsissm:initialization" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> State Initialization<a href="tsissm.html#tsissm:initialization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A key innovation of the <span class="citation">De Livera, Hyndman, and Snyder (<a href="#ref-de2011forecasting" role="doc-biblioref">2011</a>)</span> paper is providing the exact initialization
of the non-stationary component’s seed states, the exponential smoothing analogue
of the <span class="citation">De Jong et al. (<a href="#ref-de1991diffuse" role="doc-biblioref">1991</a>)</span> method for augmenting the Kalman filter to handle seed states
with infinite variances. The proof, based on <span class="citation">De Livera, Hyndman, and Snyder (<a href="#ref-de2011forecasting" role="doc-biblioref">2011</a>)</span> and expanded
here is as follows:</p>
<p>Let:</p>
<p><span class="math display" id="eq:tsissm6">\[\begin{equation}
{\bf{D}} = {\bf{F}} - {\bf{gw&#39;}}.
\tag{5.6}
\end{equation}\]</span></p>
<p>We eliminate <span class="math inline">\(\varepsilon_t\)</span> in <a href="tsissm.html#eq:tsissm1">(5.1)</a> to give:</p>
<p><span class="math display" id="eq:tsissm7">\[\begin{equation}
{{\bf{x}}_t} = {\bf{D}}{{\bf{x}}_{t - 1}} + {\bf{g}}{y_t}.
\tag{5.7}
\end{equation}\]</span></p>
<p>Next, we proceed by backsolving the equation for the error, given a given
value of <span class="math inline">\(\lambda\)</span>:<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a></p>
<p><span class="math display" id="eq:tsissm8">\[\begin{equation}
\begin{array}{l}
{\varepsilon _t} = {y_t} - {\bf{w}}{{{\bf{\hat x}}}_{t - 1}},\\
{\varepsilon _t} = {y_t} - {\bf{w&#39;}}\left( {{\bf{D}}{{{\bf{\hat x}}}_{t - 2}} + {\bf{g}}{y_{t - 1}}} \right).
\end{array}
\tag{5.8}
\end{equation}\]</span></p>
<p>Starting with <span class="math inline">\(t = 4\)</span> and working backwards:</p>
<p><span class="math display" id="eq:tsissm9">\[\begin{equation}
\begin{array}{l}
{\varepsilon _4} &amp;= {y_4} - {\bf{w&#39;}}\left( {{\bf{D}}{{{\bf{\hat x}}}_2} + {\bf{g}}{y_3}} \right)\\
&amp;= {y_4} - {\bf{w&#39;}}\left( {{\bf{D}}\left( {{\bf{D}}{{{\bf{\hat x}}}_1} + {\bf{g}}{y_2}} \right) + {\bf{g}}{y_3}} \right)\\
&amp;= {y_4} - {\bf{w&#39;}}\left( {{\bf{D}}\left( {{\bf{D}}\left( {{\bf{D}}{{{\bf{\hat x}}}_0} + {\bf{g}}{y_1}} \right) + {\bf{g}}{y_2}} \right) + {\bf{g}}{y_3}} \right)\\
&amp;= {y_4} - {\bf{w&#39;}}\left( {{\bf{D}}\left( {{{\bf{D}}^2}{{\bf{x}}_0} + {\bf{Dg}}{y_1} + {\bf{g}}{y_2}} \right) + {\bf{g}}{y_3}} \right)\\
&amp;= {y_4} - {\bf{w&#39;}}\left( {{{\bf{D}}^3}{{\bf{x}}_0} + {{\bf{D}}^2}{\bf{g}}{y_1} + {\bf{Dg}}{y_2} + {\bf{g}}{y_3}} \right)\\
&amp;= {y_4} - {\bf{w&#39;}}\sum\limits_{j = 1}^3 {{{\bf{D}}^{j - 1}}{\bf{g}}{y_{4 - j}} - {\bf{w&#39;}}{{\bf{D}}^3}{{\bf{x}}_0}} \\
\end{array}
\tag{5.9}
\end{equation}\]</span></p>
<p>and generalizing to <span class="math inline">\(\varepsilon_t\)</span>:</p>
<p><span class="math display" id="eq:tsissm10">\[\begin{equation}
\begin{array}{l}
{\varepsilon _t} &amp;= {y_t} - {\bf{w&#39;}}\left( {\sum\limits_{j = 1}^{t - 1} {{{\bf{D}}^{j - 1}}{\bf{g}}{y_{t - j}}} } \right) - {\bf{w&#39;}}{{\bf{D}}^{t - 1}}{{\bf{x}}_0}\\
&amp;= {y_t} - {\bf{w&#39;}}{{{\bf{\tilde x}}}_{t - 1}} - {{{\bf{w&#39;}}}_{t - 1}}{{\bf{x}}_0}\\
&amp;= {{\tilde y}_t} - {{{\bf{w&#39;}}}_{t - 1}}{{\bf{x}}_0},
\end{array}
\tag{5.10}
\end{equation}\]</span></p>
<p>where <span class="math inline">\({{\tilde y}_t} = {y_t} - {\bf{w&#39;}}{{{\bf{\tilde x}}}_{t - 1}}\)</span>, <span class="math inline">\({{{\bf{\tilde x}}}_t} = {\bf{D}}{{{\bf{\tilde x}}}_{t - 1}} + {\bf{g}}{y_t}\)</span>, <span class="math inline">\({{{\bf{w&#39;}}}_t} = {\bf{D}}{{{\bf{w&#39;}}}_{t - 1}}\)</span>, <span class="math inline">\({{{\bf{\tilde x}}}_0} = 0\)</span> and <span class="math inline">\({{{\bf{w&#39;}}}_0} = {\bf{w&#39;}}\)</span>, so that <span class="math inline">\(\bf{x}_0\)</span> are the coefficients from the regression of <span class="math inline">\(\bf{w}\)</span> on <span class="math inline">\(\boldsymbol{\varepsilon}\)</span>. While this approach bypasses the need to estimate the initial states by augmenting the parameter vector, which could be very costly for multiple seasonality or large seasonal periods, it still requires one full iteration for <span class="math inline">\(i=1,\dots,t\)</span> to calculate <span class="math inline">\(\boldsymbol{\varepsilon}\)</span> and <span class="math inline">\(\bf{w}\)</span> and then one inversion to get the coefficients <em>for every new set of parameters</em> (i.e. for each new candidate set in the optimization).</p>
</div>
<div id="tsissm:likelihood" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Log-Likelihood<a href="tsissm.html#tsissm:likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The log-likelihood (<span class="math inline">\(L\)</span>) of the model follows from the assumption that the
innovations <span class="math inline">\(\varepsilon_t\sim N\left(0, \sigma^2\right)\)</span>, leading to the
following form for the transformed series <span class="math inline">\(y^{\lambda}_t\)</span>:</p>
<p><span class="math display" id="eq:tsissm11">\[\begin{equation}
L\left( \theta  \right) =  - \frac{T}{2}\log \left( {2\pi {{\sigma }^2}} \right) - \frac{1}{{2{{\sigma }^2}}}\sum\limits_{t = 1}^T {\varepsilon _t^2 + \left( {\lambda  - 1} \right)\sum\limits_{t = 1}^T {\log {y_t}} }.
\tag{5.11}
\end{equation}\]</span></p>
<p>Concentrating out <span class="math inline">\(\sigma^2\)</span> with its maximum likelihood estimate, <span class="math inline">\({\hat \sigma^2} = {T^{ - 1}}\sum\limits_{t = 1}^T {\varepsilon_t^2}\)</span>, eliminating constants and taking the negative for minimization in the optimization routine leads to the following form:</p>
<p><span class="math display" id="eq:tsissm12">\[\begin{equation}
L\left( \theta  \right) = T\log \sum\limits_{t = 1}^T {\varepsilon _t^2}  - 2\left( {\lambda  - 1} \right)\sum\limits_{t = 1}^T {\log {y_t}},
\tag{5.12}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\theta\)</span> is the vector of parameters being optimized. The returned value of calling method <code>logLik</code> on an object of class <code>tsissm.estimate</code> is that of equation <a href="tsissm.html#eq:tsissm11">(5.11)</a>.</p>
</div>
<div id="tsissm:implementation" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Package Implementation<a href="tsissm.html#tsissm:implementation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The implementation of the model in the <strong>tsissm</strong> package differs significantly
from the one provided by <span class="citation">R. Hyndman et al. (<a href="#ref-R-forecast" role="doc-biblioref">2022</a>)</span> in the <code>tbats</code> and <code>bats</code> functions, mainly
in terms of a more flexible specification object and more complete methods for
working with the model.</p>
<p>Additionally, in order to ensure that the parameters are within the forecastability
region, we constrain the characteristics roots of the matrix <span class="math inline">\(\bf{D}\)</span> in <a href="tsissm.html#eq:tsissm2">(5.2)</a>,
representing the non-stationary components to be inside the unit circle, and also
constrain the ARMA roots for stationarity.<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></p>
</div>
<div id="tsissm:demonstration" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Demonstration<a href="tsissm.html#tsissm:demonstration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="tsissm:demonstration:specification" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Specification<a href="tsissm.html#tsissm:demonstration:specification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The specification function defines the entry point for setting up an issm model:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="tsissm.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsissm)</span>
<span id="cb72-2"><a href="tsissm.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(issm_modelspec)</span></code></pre></div>
<pre><code>## function (y, slope = TRUE, slope_damped = FALSE, seasonal = FALSE, 
##     seasonal_frequency = 1, seasonal_type = c(&quot;trigonometric&quot;, 
##         &quot;regular&quot;), seasonal_harmonics = NULL, ar = 0, ma = 0, 
##     xreg = NULL, transformation = &quot;box-cox&quot;, lambda = 1, lower = 0, 
##     upper = 1, sampling = NULL, ...) 
## NULL</code></pre>
<p>The specification has options for slope, dampening, seasonality (trigonometric and regular),<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> AR and MA terms and external regressors. Additionally, lambda can be fixed or
estimated (by setting <code>lambda = NA</code>). Automatic selection model selection and ranking based on AIC
is available via the <code>auto_issm</code> function.</p>
</div>
<div id="tsissm:demonstration:estimation" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Estimation<a href="tsissm.html#tsissm:demonstration:estimation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We showcase the functionality of the package using the electricload dataset from
the <strong>tsdatasets</strong> package which represents total hourly electricity load in Greece
in MW as published on ENTSO-E Transparency Platform, for the period 2016-10-17 to 2019-04-30.
The series appears to have multiple seasonality with periodicity
24, <span class="math inline">\(24\times 7\)</span> and <span class="math inline">\(24\times 7 \times 52\)</span>, which we model with trigonometric terms.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="tsissm.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsissm)</span>
<span id="cb74-2"><a href="tsissm.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;electricload&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tsdatasets&quot;</span>)</span>
<span id="cb74-3"><a href="tsissm.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># specification</span></span>
<span id="cb74-4"><a href="tsissm.html#cb74-4" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">issm_modelspec</span>(electricload, <span class="at">slope =</span> T, <span class="at">seasonal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb74-5"><a href="tsissm.html#cb74-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_frequency =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">4500</span>),</span>
<span id="cb74-6"><a href="tsissm.html#cb74-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_type =</span> <span class="st">&quot;trigonometric&quot;</span>, </span>
<span id="cb74-7"><a href="tsissm.html#cb74-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_harmonics =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">6</span>), <span class="at">ar =</span> <span class="dv">2</span>, <span class="at">ma =</span> <span class="dv">2</span>, </span>
<span id="cb74-8"><a href="tsissm.html#cb74-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lambda =</span> <span class="fl">0.25</span>)</span>
<span id="cb74-9"><a href="tsissm.html#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co"># estimation</span></span>
<span id="cb74-10"><a href="tsissm.html#cb74-10" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(<span class="fu">estimate</span>(spec, <span class="at">solver =</span> <span class="st">&quot;nlminb&quot;</span>))</span>
<span id="cb74-11"><a href="tsissm.html#cb74-11" aria-hidden="true" tabindex="-1"></a>mod<span class="sc">$</span>opt<span class="sc">$</span>elapsed</span></code></pre></div>
<pre><code>## Time difference of 2.290731 mins</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="tsissm.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code></pre></div>
<pre><code>## ISSM Model: AAA(24{6}/4500{6})+ARMA(2,2)
## 
## Parameter      Est[Value]   Lower   Upper   Std. Error    t value   Pr(&gt;|t|)
## ------------  -----------  ------  ------  -----------  ---------  ---------
## alpha              0.2961    0.00    0.99       0.1381     2.1436     0.0321
## beta               0.0000    0.00    0.99          NaN        NaN        NaN
## gamma24.1          0.0345   -0.01    0.99       0.0009    38.5761     0.0000
## gamma24.2          0.0147   -0.01    0.99       0.0006    24.9130     0.0000
## gamma4500.1        0.1805   -0.01    0.99       0.0231     7.8308     0.0000
## gamma4500.2       -0.0100   -0.01    0.99          NaN        NaN        NaN
## theta1            -0.3438   -0.99    0.99       0.0104   -33.1414     0.0000
## theta2            -0.4971   -0.99    0.99       0.0096   -51.5499     0.0000
## psi1              -0.1066   -0.99    0.99       0.0072   -14.7263     0.0000
## psi2               0.7020   -0.99    0.99       0.0066   105.7564     0.0000
## lambda             0.2500    0.25    0.25          NaN        NaN        NaN
## 
## tsissm: Performance Metrics
## ----------------------------------
## AIC  : 437349.96 (n = 40)
## MAPE : 0.01662
## BIAS : 0.00023
## MSLRE    : 0.00048</code></pre>
<p>The <code>plot</code> method decomposes the estimated model into it’s components:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="tsissm.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_plot-1.png" width="768" /></p>
<p>but we can also extract these directly and plot them using the <code>tsdecompose</code> method:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="tsissm.html#cb79-1" aria-hidden="true" tabindex="-1"></a>td <span class="ot">&lt;-</span> <span class="fu">tsdecompose</span>(mod)</span>
<span id="cb79-2"><a href="tsissm.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.zoo</span>(td), <span class="at">main  =</span> <span class="st">&quot;ISSM Decomposition&quot;</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_methods1-1.png" width="768" /></p>
<p>Additional inference methods include diagnostics (<code>tsdiagnose</code>) as well as
standard extractors for the coefficients (<code>coef</code>), log-likelihood (<code>logLik</code>) and AIC (<code>AIC</code>):</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="tsissm.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tsdiagnose</span>(mod, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## ARMA roots
## ------------------------------------------
## Inverse AR roots: 0.7050694 0.7050694
## Inverse MA roots: 0.8378323 0.8378323
## 
## Forecastability (D roots)
## ------------------------------------------
## Real Eigenvalues (D): 1 1 1 1 1 1 1 1 1 1 1 1 1 0.964 0.964 0.862 0.862 0.701 0.701 0.492 0.492 0.248 0.248 0.015 0.015 0.053 0.053 0.496 0 0
## 
## Weighted Ljung-Box Test [scaled residuals]
## ------------------------------------------
##      Lag statistic  pvalue
##   &lt;char&gt;     &lt;num&gt;   &lt;num&gt;
##   Lag[1]      31.8 1.7e-08
##  Lag[11]     280.3 0.0e+00
##  Lag[11]     280.3 0.0e+00
##  Lag[11]     280.3 0.0e+00
## 
## Outlier Diagnostics (based on Rosner Test)
## ------------------------------------------
## Outliers: 2017-05-10 19:00:00 2019-01-22 14:00:00 2019-01-22 08:00:00 2019-01-22 17:00:00 2019-01-22 09:00:00 2019-01-22 05:00:00 2019-01-12 07:00:00 2017-03-02 17:00:00 2016-11-29 10:00:00 2016-11-08 17:00:00</code></pre>
<p><img src="tsmodels_files/figure-html/issm_methods2-1.png" width="672" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="tsissm.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod)</span></code></pre></div>
<pre><code>##         alpha          beta     gamma24.1     gamma24.2   gamma4500.1 
##  2.960931e-01  1.000000e-12  3.447394e-02  1.469827e-02  1.805444e-01 
##   gamma4500.2        theta1        theta2          psi1          psi2 
## -1.000000e-02 -3.437839e-01 -4.971229e-01 -1.066188e-01  7.019629e-01</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="tsissm.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(mod)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -138954.3 (df=41)</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="tsissm.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod)</span></code></pre></div>
<pre><code>## [1] 437350</code></pre>
</div>
<div id="tsissm:demonstration:prediction" class="section level3 hasAnchor" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Prediction<a href="tsissm.html#tsissm:demonstration:prediction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Similar to the other packages in the <code>tsmodels</code> framework, prediction builds a distribution
of possible paths by simulation, outputting an object of class <code>tsmodel.predict</code>:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="tsissm.html#cb88-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">h =</span> <span class="dv">24</span><span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb88-2"><a href="tsissm.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="at">n_original =</span> <span class="dv">24</span><span class="sc">*</span><span class="dv">20</span>, <span class="at">main =</span> <span class="st">&quot;10-Day Hourly Forecast&quot;</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_predict-1.png" width="672" /></p>
<p>The <code>predict</code> object also has a decomposition method:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="tsissm.html#cb89-1" aria-hidden="true" tabindex="-1"></a>td <span class="ot">&lt;-</span> <span class="fu">tsdecompose</span>(p)</span>
<span id="cb89-2"><a href="tsissm.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>),<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb89-3"><a href="tsissm.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(td<span class="sc">$</span>Level, <span class="at">n_original =</span> <span class="dv">24</span><span class="sc">*</span><span class="dv">20</span>, <span class="at">main =</span> <span class="st">&quot;Level[State] Predicted Distribution&quot;</span>)</span>
<span id="cb89-4"><a href="tsissm.html#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(td<span class="sc">$</span>Seasonal24, <span class="at">n_original =</span> <span class="dv">24</span><span class="sc">*</span><span class="dv">20</span>, </span>
<span id="cb89-5"><a href="tsissm.html#cb89-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Seasonal24[State] Predicted Distribution&quot;</span>)</span>
<span id="cb89-6"><a href="tsissm.html#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(td<span class="sc">$</span>Seasonal4500, <span class="at">n_original =</span> <span class="dv">24</span><span class="sc">*</span><span class="dv">20</span>,</span>
<span id="cb89-7"><a href="tsissm.html#cb89-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Seasonal4500[State] Predicted Distribution&quot;</span>)</span>
<span id="cb89-8"><a href="tsissm.html#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(td<span class="sc">$</span>AR2, <span class="at">n_original =</span> <span class="dv">24</span><span class="sc">*</span><span class="dv">20</span>, <span class="at">main =</span> <span class="st">&quot;AR2[State] Predicted Distribution&quot;</span>)</span>
<span id="cb89-9"><a href="tsissm.html#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(td<span class="sc">$</span>MA2, <span class="at">n_original =</span> <span class="dv">24</span><span class="sc">*</span><span class="dv">20</span>, <span class="at">main =</span> <span class="st">&quot;MA2[State] Predicted Distribution&quot;</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_predict_decompose-1.png" width="768" /></p>
</div>
<div id="tsissm:demonstration:simulation" class="section level3 hasAnchor" number="5.5.4">
<h3><span class="header-section-number">5.5.4</span> Simulation<a href="tsissm.html#tsissm:demonstration:simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Simulation of an estimated object has options for changing the coefficients as
well as the initial states, as well as the option for providing custom
innovations or bootstrapped innovations:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="tsissm.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(tsissm<span class="sc">:::</span>simulate.tsissm.estimate)</span></code></pre></div>
<pre><code>## function (object, nsim = 1, seed = NULL, h = NULL, newxreg = NULL, 
##     sim_dates = NULL, bootstrap = FALSE, innov = NULL, sigma_scale = 1, 
##     pars = coef(object), init_states = object$spec$xseed, ...) 
## NULL</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="tsissm.html#cb92-1" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">simulate</span>(mod, <span class="at">nsim =</span> <span class="dv">100</span>, <span class="at">h =</span> <span class="dv">24</span> <span class="sc">*</span> <span class="dv">10</span>, <span class="at">bootstrap =</span> <span class="cn">TRUE</span>)</span>
<span id="cb92-2"><a href="tsissm.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_simulation-1.png" width="768" /></p>
<p>While the plot function on a simulated object provides a decomposition of the
actual and state components distributions, it is useful to remind ourselves that
the distribution bands represent the range of uncertainty of multiple paths.
This is best illustrated by plotting these separately:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="tsissm.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">as.POSIXct</span>(<span class="fu">colnames</span>(sim<span class="sc">$</span>Simulated)), <span class="fu">t</span>(sim<span class="sc">$</span>Simulated), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb93-2"><a href="tsissm.html#cb93-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Simulated Paths&quot;</span>)</span>
<span id="cb93-3"><a href="tsissm.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="tsissm:demonstration:filtering" class="section level3 hasAnchor" number="5.5.5">
<h3><span class="header-section-number">5.5.5</span> Filtering<a href="tsissm.html#tsissm:demonstration:filtering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Online filtering is when new data arrives and instead of re-estimating the model,
we instead just filter the new data based on an existing model. In the <strong>tsissm</strong>
package the <code>tsfilter</code> method updates an object of class <code>tsmodel.estimate</code> with
new data as the example below illustrates. Because the class of the model
is retained and only updated (both data and states) with new information,
it is also possible to apply any method to that which admits that object (e.g. <code>predict</code>).</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="tsissm.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsissm)</span>
<span id="cb94-2"><a href="tsissm.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(xts))</span>
<span id="cb94-3"><a href="tsissm.html#cb94-3" aria-hidden="true" tabindex="-1"></a>weekends <span class="ot">&lt;-</span> <span class="fu">xts</span>(<span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(electricload)), <span class="fu">index</span>(electricload))</span>
<span id="cb94-4"><a href="tsissm.html#cb94-4" aria-hidden="true" tabindex="-1"></a>weekends[<span class="fu">which</span>(<span class="fu">weekdays</span>(<span class="fu">as.Date</span>(<span class="fu">index</span>(weekends))) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Saturday&quot;</span>,<span class="st">&quot;Sunday&quot;</span>))] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb94-5"><a href="tsissm.html#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(weekends) <span class="ot">&lt;-</span> <span class="st">&quot;weekend&quot;</span></span>
<span id="cb94-6"><a href="tsissm.html#cb94-6" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">issm_modelspec</span>(electricload[<span class="dv">1</span><span class="sc">:</span><span class="dv">22000</span>], <span class="at">slope =</span> <span class="cn">TRUE</span>, <span class="at">seasonal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb94-7"><a href="tsissm.html#cb94-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_frequency =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">4500</span>), <span class="at">xreg =</span> weekends[<span class="dv">1</span><span class="sc">:</span><span class="dv">22000</span>],</span>
<span id="cb94-8"><a href="tsissm.html#cb94-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_type =</span> <span class="st">&quot;trigonometric&quot;</span>, </span>
<span id="cb94-9"><a href="tsissm.html#cb94-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_harmonics =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">6</span>), <span class="at">ar =</span> <span class="dv">2</span>, <span class="at">ma =</span> <span class="dv">2</span>, </span>
<span id="cb94-10"><a href="tsissm.html#cb94-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lambda =</span> <span class="fl">0.25</span>)</span>
<span id="cb94-11"><a href="tsissm.html#cb94-11" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">estimate</span>(spec, <span class="at">solver =</span> <span class="st">&quot;nlminb&quot;</span>)</span>
<span id="cb94-12"><a href="tsissm.html#cb94-12" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">tsfilter</span>(mod, <span class="at">y =</span> electricload[<span class="dv">22001</span><span class="sc">:</span><span class="dv">22100</span>], <span class="at">newxreg =</span> weekends[<span class="dv">22001</span><span class="sc">:</span><span class="dv">22100</span>])</span>
<span id="cb94-13"><a href="tsissm.html#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">fitted</span>(mod))</span></code></pre></div>
<pre><code>## Warning: timezone of object (UTC) is different than current timezone ().</code></pre>
<pre><code>##                         [,1]
## 2019-04-21 10:00:00 5602.398
## 2019-04-21 11:00:00 5505.524
## 2019-04-21 12:00:00 5089.799
## 2019-04-21 13:00:00 4911.070
## 2019-04-21 14:00:00 4831.108
## 2019-04-21 15:00:00 5042.946</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="tsissm.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">tail</span>(<span class="fu">fitted</span>(f1), <span class="dv">100</span>),<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Warning: timezone of object (UTC) is different than current timezone ().</code></pre>
<pre><code>##                         [,1]
## 2019-04-21 16:00:00 5446.961
## 2019-04-21 17:00:00 5795.905
## 2019-04-21 18:00:00 6158.819
## 2019-04-21 19:00:00 5908.761
## 2019-04-21 20:00:00 5284.804
## 2019-04-21 21:00:00 4888.972
## 2019-04-21 22:00:00 4499.164
## 2019-04-21 23:00:00 4216.602
## 2019-04-22 00:00:00 4185.699
## 2019-04-22 01:00:00 4105.256</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="tsissm.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f1)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_filtering-1.png" width="768" /></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="tsissm.html#cb101-1" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">tsfilter</span>(f1, <span class="at">y =</span> electricload[<span class="dv">22100</span><span class="sc">:</span><span class="dv">22200</span>], <span class="at">newxreg =</span> weekends[<span class="dv">22100</span><span class="sc">:</span><span class="dv">22200</span>])</span>
<span id="cb101-2"><a href="tsissm.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">fitted</span>(f1))</span></code></pre></div>
<pre><code>## Warning: timezone of object (UTC) is different than current timezone ().</code></pre>
<pre><code>##                         [,1]
## 2019-04-25 14:00:00 5741.715
## 2019-04-25 15:00:00 5759.517
## 2019-04-25 16:00:00 5970.261
## 2019-04-25 17:00:00 6054.623
## 2019-04-25 18:00:00 6082.171
## 2019-04-25 19:00:00 5672.456</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="tsissm.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">tail</span>(<span class="fu">fitted</span>(f2), <span class="dv">100</span>),<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Warning: timezone of object (UTC) is different than current timezone ().</code></pre>
<pre><code>##                         [,1]
## 2019-04-25 20:00:00 5079.625
## 2019-04-25 21:00:00 4757.516
## 2019-04-25 22:00:00 4393.659
## 2019-04-25 23:00:00 4187.004
## 2019-04-26 00:00:00 4145.853
## 2019-04-26 01:00:00 4059.955
## 2019-04-26 02:00:00 3973.271
## 2019-04-26 03:00:00 4221.322
## 2019-04-26 04:00:00 4393.471
## 2019-04-26 05:00:00 4598.862</code></pre>
</div>
<div id="tsissm:demonstration:profiling" class="section level3 hasAnchor" number="5.5.6">
<h3><span class="header-section-number">5.5.6</span> Profiling<a href="tsissm.html#tsissm:demonstration:profiling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>tsprofile</code> function profiles an estimated model by simulating and then estimating multiple paths from the assumed DGP while leaving <code>h</code> values out for prediction evaluation. Each simulated path is equal to the size of the original dataset plus <code>h</code> additional values, and initialized with the initial state vector from the model. The resulting output contains the distribution of the MAPE, percent bias (BIAS) and mean squared log relative error (MSLRE) per horizon <code>h</code>. Since these matrices are of class <code>tsmodel.distribution</code> they can be readily plotted with the special purpose <code>plot</code> function for this class from the <strong>tsmethods</strong> package. Additionally, a data.table matrix is also returned with the distribution of the coefficients from each path estimation.
As of version 0.2.0, the <code>tsprofile</code> method on a <code>tsissm.estimate</code> object does not support <code>newxreg</code>.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="tsissm.html#cb107-1" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">issm_modelspec</span>(electricload[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">24</span><span class="sc">*</span><span class="dv">24</span>)], <span class="at">slope =</span> T, <span class="at">seasonal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb107-2"><a href="tsissm.html#cb107-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_frequency =</span> <span class="fu">c</span>(<span class="dv">24</span>),</span>
<span id="cb107-3"><a href="tsissm.html#cb107-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_type =</span> <span class="st">&quot;trigonometric&quot;</span>, </span>
<span id="cb107-4"><a href="tsissm.html#cb107-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_harmonics =</span> <span class="fu">c</span>(<span class="dv">6</span>), <span class="at">ar =</span> <span class="dv">2</span>, <span class="at">ma =</span> <span class="dv">2</span>, </span>
<span id="cb107-5"><a href="tsissm.html#cb107-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lambda =</span> <span class="fl">0.25</span>)</span>
<span id="cb107-6"><a href="tsissm.html#cb107-6" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">estimate</span>(spec, <span class="at">solver =</span> <span class="st">&quot;nlminb&quot;</span>)</span>
<span id="cb107-7"><a href="tsissm.html#cb107-7" aria-hidden="true" tabindex="-1"></a>prof <span class="ot">&lt;-</span> <span class="fu">tsprofile</span>(mod, <span class="at">h =</span> <span class="dv">24</span><span class="sc">*</span><span class="dv">7</span>, <span class="at">nsim =</span> <span class="dv">100</span>, <span class="at">solver =</span> <span class="st">&quot;nlminb&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: UNRELIABLE VALUE: Future (&#39;&lt;none&gt;&#39;) unexpectedly generated random
## numbers without specifying argument &#39;seed&#39;. There is a risk that those random
## numbers are not statistically sound and the overall results might be invalid.
## To fix this, specify &#39;seed=TRUE&#39;. This ensures that proper, parallel-safe random
## numbers are produced via the L&#39;Ecuyer-CMRG method. To disable this check, use
## &#39;seed=NULL&#39;, or set option &#39;future.rng.onMisuse&#39; to &quot;ignore&quot;.</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="tsissm.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prof)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_profile-1.png" width="768" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="tsissm.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prof, <span class="at">type =</span> <span class="st">&quot;coef&quot;</span>)</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_profile-2.png" width="768" /></p>
</div>
<div id="tsissm:demonstration:backtesting" class="section level3 hasAnchor" number="5.5.7">
<h3><span class="header-section-number">5.5.7</span> Backtesting<a href="tsissm.html#tsissm:demonstration:backtesting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>tsbacktest</code> method generates an expanding window walk forward backtest, returning a list with the estimation/horizon predictions against actuals as well as a table of average performance metrics by horizon. Optionally, instead of re-estimating every one period, the
option to re-estimate every n-periods is available via the <code>estimate_every</code> option.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="tsissm.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(future))</span>
<span id="cb111-2"><a href="tsissm.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(<span class="fu">list</span>(</span>
<span id="cb111-3"><a href="tsissm.html#cb111-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tweak</span>(sequential),</span>
<span id="cb111-4"><a href="tsissm.html#cb111-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tweak</span>(multisession, <span class="at">workers =</span> <span class="dv">5</span>)</span>
<span id="cb111-5"><a href="tsissm.html#cb111-5" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb111-6"><a href="tsissm.html#cb111-6" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">issm_modelspec</span>(electricload[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">24</span><span class="sc">*</span><span class="dv">24</span>)], <span class="at">slope =</span> T, <span class="at">seasonal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb111-7"><a href="tsissm.html#cb111-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_frequency =</span> <span class="fu">c</span>(<span class="dv">24</span>),</span>
<span id="cb111-8"><a href="tsissm.html#cb111-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_type =</span> <span class="st">&quot;trigonometric&quot;</span>, </span>
<span id="cb111-9"><a href="tsissm.html#cb111-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_harmonics =</span> <span class="fu">c</span>(<span class="dv">6</span>), <span class="at">ar =</span> <span class="dv">2</span>, <span class="at">ma =</span> <span class="dv">2</span>, </span>
<span id="cb111-10"><a href="tsissm.html#cb111-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lambda =</span> <span class="fl">0.25</span>)</span>
<span id="cb111-11"><a href="tsissm.html#cb111-11" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">tsbacktest</span>(spec, <span class="at">start =</span> <span class="dv">24</span><span class="sc">*</span><span class="dv">12</span>, <span class="at">h =</span> <span class="dv">24</span>, <span class="at">estimate_every =</span> <span class="dv">24</span>, <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.1</span>), </span>
<span id="cb111-12"><a href="tsissm.html#cb111-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">data_name =</span> <span class="st">&quot;electricity&quot;</span>, <span class="at">solver =</span> <span class="st">&quot;nlminb&quot;</span>, <span class="at">autodiff =</span> <span class="cn">TRUE</span>, </span>
<span id="cb111-13"><a href="tsissm.html#cb111-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">trace =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning: UNRELIABLE VALUE: Future (&#39;&lt;none&gt;&#39;) unexpectedly generated random
## numbers without specifying argument &#39;seed&#39;. There is a risk that those random
## numbers are not statistically sound and the overall results might be invalid.
## To fix this, specify &#39;seed=TRUE&#39;. This ensures that proper, parallel-safe random
## numbers are produced via the L&#39;Ecuyer-CMRG method. To disable this check, use
## &#39;seed=NULL&#39;, or set option &#39;future.rng.onMisuse&#39; to &quot;ignore&quot;.</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="tsissm.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(b<span class="sc">$</span>metrics)</span></code></pre></div>
<pre><code>##    horizon    variable       MAPE       MSLRE          BIAS  n MIS[0.02]
## 1:       1 electricity 0.04190210 0.003309235 -0.0236839237 12  5998.228
## 2:       2 electricity 0.04867266 0.004278126 -0.0137657649 12  6205.653
## 3:       3 electricity 0.06539931 0.007050628  0.0008472191 12  7406.479
## 4:       4 electricity 0.07501513 0.008072229 -0.0090672231 12  5777.668
## 5:       5 electricity 0.07535560 0.009468918 -0.0222899079 12  7845.072
## 6:       6 electricity 0.09600599 0.013778439 -0.0254790898 12 12528.816
##    MIS[0.1]
## 1: 1774.305
## 2: 2028.161
## 3: 2361.633
## 4: 2365.149
## 5: 3083.159
## 6: 4400.748</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="tsissm.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(b<span class="sc">$</span>metrics<span class="sc">$</span>horizon, b<span class="sc">$</span>metrics<span class="sc">$</span>MAPE<span class="sc">*</span><span class="dv">100</span>, <span class="at">main =</span> <span class="st">&quot;Horizon MAPE&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb115-2"><a href="tsissm.html#cb115-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;MAPE[%]&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;horizon&quot;</span>)</span>
<span id="cb115-3"><a href="tsissm.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img src="tsmodels_files/figure-html/issm_backtest-1.png" width="768" /></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="tsissm.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(sequential)</span></code></pre></div>
<p>The variable <code>n</code> in the table reports the number of h-step ahead predictions made on which the average metrics were calculated.</p>
</div>
<div id="tsissm:demonstration:benchmarking" class="section level3 hasAnchor" number="5.5.8">
<h3><span class="header-section-number">5.5.8</span> Benchmarking<a href="tsissm.html#tsissm:demonstration:benchmarking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>tsbenchmark*</code> method is used to benchmark a model for timing and accuracy and can be used as a unit testing function.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="tsissm.html#cb117-1" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">issm_modelspec</span>(electricload[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">24</span><span class="sc">*</span><span class="dv">50</span>)], <span class="at">slope =</span> T, <span class="at">seasonal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb117-2"><a href="tsissm.html#cb117-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_frequency =</span> <span class="fu">c</span>(<span class="dv">24</span>),</span>
<span id="cb117-3"><a href="tsissm.html#cb117-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_type =</span> <span class="st">&quot;trigonometric&quot;</span>, </span>
<span id="cb117-4"><a href="tsissm.html#cb117-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">seasonal_harmonics =</span> <span class="fu">c</span>(<span class="dv">6</span>), <span class="at">ar =</span> <span class="dv">2</span>, <span class="at">ma =</span> <span class="dv">2</span>, </span>
<span id="cb117-5"><a href="tsissm.html#cb117-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lambda =</span> <span class="fl">0.25</span>)</span>
<span id="cb117-6"><a href="tsissm.html#cb117-6" aria-hidden="true" tabindex="-1"></a>bench <span class="ot">&lt;-</span> <span class="fu">tsbenchmark</span>(spec, <span class="at">solver =</span> <span class="st">&quot;nlminb&quot;</span>, <span class="at">autodiff =</span> <span class="cn">TRUE</span>)</span>
<span id="cb117-7"><a href="tsissm.html#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bench)</span></code></pre></div>
<pre><code>##                  start                 end              spec
## 1: 2022-05-12 13:51:03 2022-05-12 13:51:04 &lt;tsissm.spec[11]&gt;
##                estimate solver control    loglik
## 1: &lt;tsissm.estimate[6]&gt; nlminb       0 -7377.924</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="tsissm.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bench<span class="sc">$</span>end <span class="sc">-</span> bench<span class="sc">$</span>start)</span></code></pre></div>
<pre><code>## Time difference of 0.817574 secs</code></pre>
<p>The implementation of the constraints for both the <span class="math inline">\(\bf{D}\)</span> matrix as well as the
ARMA roots are non-smooth and hence care should be taken in checking the solution.</p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-anderson2012optimal" class="csl-entry">
Anderson, Brian DO, and John B Moore. 2012. <em>Optimal Filtering</em>. Courier Corporation.
</div>
<div id="ref-de1991diffuse" class="csl-entry">
De Jong, Piet et al. 1991. <span>“The Diffuse Kalman Filter.”</span> <em>The Annals of Statistics</em> 19 (2): 1073–83.
</div>
<div id="ref-de2011forecasting" class="csl-entry">
De Livera, Alysha M, Rob J Hyndman, and Ralph D Snyder. 2011. <span>“Forecasting Time Series with Complex Seasonal Patterns Using Exponential Smoothing.”</span> <em>Journal of the American Statistical Association</em> 106 (496): 1513–27.
</div>
<div id="ref-R-forecast" class="csl-entry">
Hyndman, Rob, George Athanasopoulos, Christoph Bergmeir, Gabriel Caceres, Leanne Chhay, Mitchell O’Hara-Wild, Fotios Petropoulos, Slava Razbash, Earo Wang, and Farah Yasmeen. 2022. <em>Forecast: Forecasting Functions for Time Series and Linear Models</em>. <a href="https://CRAN.R-project.org/package=forecast">https://CRAN.R-project.org/package=forecast</a>.
</div>
<div id="ref-hyndman2008" class="csl-entry">
Hyndman, Rob, Anne B Koehler, J Keith Ord, and Ralph D Snyder. 2008. <em>Forecasting with Exponential Smoothing: The State Space Approach</em>. Springer Science &amp; Business Media.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>The following equations apply for the case when all components are present (level, slope, seasonal and ARMA).<a href="tsissm.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>For <span class="math inline">\(j=1,\dots,k_i\)</span> and <span class="math inline">\(i=1,\dots,T\)</span>, representing the number of harmonics <span class="math inline">\(k\)</span> per seasonal period <span class="math inline">\(i\)</span>.<a href="tsissm.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>For simplicity of exposition, <span class="math inline">\(y_t\)</span> is equivalent to <span class="math inline">\(y_t^{(\lambda)}\)</span>.<a href="tsissm.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>So that the inverse of the characteristic roots are inside the unit circle.<a href="tsissm.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>Currently, multiple seasonality is not implemented for the regular case, but will be added in due course.<a href="tsissm.html#fnref14" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tsets.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tsvets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
